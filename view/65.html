<!doctype html>
<html lang="zh-cn" >
<head>
    <meta charset="utf-8">
    <link rel="icon" href="data:image/ico;base64,aWNv">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link href="https://file.depy.ink/theme/docs/css/bootstrap.min.css?v=8280" rel="stylesheet">
    <link href="https://file.depy.ink/theme/docs/css/main.css?v=3525" rel="stylesheet">
    <script src="https://file.depy.ink/theme/docs/js/jquery.min.js"></script>
    <script src="https://file.depy.ink/theme/docs/js/bootstrap.min.js?v=4094"></script>
    <script src="https://file.depy.ink/theme/docs/js/functions.js?v=8141"></script>
    <script src="https://file.depy.ink/theme/docs/js/marked.min.js"></script>
    <link href="https://file.depy.ink/theme/docs/css/doc.css?v=4299" rel="stylesheet">
    <link rel="stylesheet" href="https://file.depy.ink/assets/editor/editormd/css/editormd.css?v=6567" />
    <script src="https://file.depy.ink/assets/editor/editormd/editormd.js"></script>
    <script src="https://file.depy.ink/assets/editor/editormd/lib/marked.min.js"></script>
    <script src="https://file.depy.ink/assets/editor/editormd/lib/prettify.min.js"></script>

    <script src="https://file.depy.ink/theme/docs/js/pjax.min.js"></script>
    


    <script src="https://file.depy.ink/theme/docs/js/lightbox-plus-jquery.min.js"> </script>
    <link href="https://file.depy.ink/theme/docs/css/lightbox.css?v=3328" rel="stylesheet"><title>ğŸ§® JSVMPæ‰§è¡Œæµç¨‹åˆ†æ</title>
</head>

<body class="bg-light ready sticky" id="watermark">


             <nav class="navbar navbar-expand-lg navbar-light shadow-sm bg-white mybt2 sticky-top">
        <div class="container-fluid" style="max-width:1332px;">
            <a class="navbar-brand" href="/"><b class="">Depy's docs</b></a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
                        <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav mr-auto">
                    <li class="nav-item active">
                        <a class="nav-link" href="/" >é¦–é¡µ</a>
                    </li>

                </ul>

            </div>
        </div>
    </nav>


<main>


<aside class="sidebar">
           <div class="sidebar-nav mt-2">
            <ul>
            <li>

 <p>DepyDocs</p>
    <ul>
<li><a href="/view/122.html">ğŸ“‘ DepyDocs</a></li>
<li><a href="/view/120.html">ğŸ“‘  Un1kMsgä½¿ç”¨</a></li>
<li><a href="/view/114.html">ğŸ“‘ è”ç³»æ–¹å¼</a></li>
<li><a href="/view/91.html">ğŸ“‘ é¢å¤–é…ç½®</a></li>
<li><a href="/view/88.html">ğŸ“‘  æ›´æ–°æ—¥å¿—</a></li>
<li><a href="/view/72.html">ğŸ“‘ æ—¶å…‰æœºä½¿ç”¨</a></li>
<li><a href="/view/66.html">ğŸ“‘ DepyOauthæ¥å…¥æŒ‡å—</a></li>
<li><a href="/view/62.html">ğŸ“‘ å®˜æ–¹åŸŸåç”³è¯·</a></li>
<li><a href="/view/47.html">ğŸ“‘ ç§Ÿæˆ·è‡ªå®šä¹‰åŸŸåç»‘å®š</a></li>
    </ul>
 <p>åšå®¢æ–‡ç« ï¼ˆå¤‡ä»½ï¼‰</p>
    <ul>
<li><a href="/view/137.html">æµ™æ±Ÿçœç¬¬å››å±Šç½‘ç»œä¸ä¿¡æ¯å®‰å…¨ç«èµ›å†³èµ›WP</a></li>
<li><a href="/view/136.html">æµé‡åŠ å¯†ç¼–ç¨‹å¼€å‘</a></li>
<li><a href="/view/135.html">Attack PHP Website By Shiro</a></li>
<li><a href="/view/134.html">æŸOAæˆæƒç ´è§£åˆ†æ</a></li>
<li><a href="/view/133.html">Un1kHacking</a></li>
<li><a href="/view/132.html">Un1kLog4shellScan </a></li>
<li><a href="/view/131.html">Netty å¼€å‘Mitmè§£å†³è¯·æ±‚å“åº”åŒ¹é…é—®é¢˜	</a></li>
    </ul>
 <p>Todo</p>
    <ul>
<li><a href="/view/118.html">Todo List</a></li>
    </ul>
 <p>éšç¬”</p>
    <ul>
<li><a href="/view/128.html">å°å¹´</a></li>
<li><a href="/view/109.html">â¤ 2023</a></li>
    </ul>
 <p>æµ‹è¯•ç¬”è®°</p>
    <ul>
<li><a href="/view/129.html">ğŸ˜¡ å…³äºDDOSæˆ‘èƒ½åšä»€ä¹ˆ</a></li>
<li><a href="/view/123.html">ğŸ‘ æŸåŠ å¯†æ ·æœ¬ Traceåˆ†æ - 2</a></li>
<li><a href="/view/121.html">ğŸ‘ æŸåŠ å¯†æ ·æœ¬ Traceåˆ†æ</a></li>
<li><a href="/view/115.html">ğŸ”§ è½»é‡çº§CI/CD+æ–‡ä»¶å†…å®¹ç›‘æ§/é˜²ç¯¡æ”¹è§£å†³æ–¹æ¡ˆ</a></li>
<li><a href="/view/105.html">ğŸ¯ æœ‰ç”¨çš„å‘½ä»¤å¤‡ä»½</a></li>
<li><a href="/view/94.html">ğŸ˜Š Gateway-wokerå®ç°çƒ­é‡è½½</a></li>
<li><a href="/view/90.html">âœï¸ Xposedè¿è¡ŒåŸç†</a></li>
<li><a href="/view/89.html">AutoJS æ¨¡æ‹Ÿè´å¡å°”æ›²çº¿è§†é¢‘æ»‘åŠ¨</a></li>
<li><a href="/view/84.html">ğŸ“± å°ç±³13ç»•è¿‡SIMå¡æ‰“å¼€USBå®‰è£…</a></li>
    </ul>
 <p>è¯»ä¹¦ç¬”è®°</p>
    <ul>
<li><a href="/view/119.html">ğŸ“š æ³¨å…¥ä¸HOOK</a></li>
<li><a href="/view/117.html">ğŸ“šã€Šæ·±å…¥æ¢ç´¢å®‰å“çƒ­ä¿®å¤æŠ€æœ¯åŸç†ã€‹32 -</a></li>
<li><a href="/view/112.html">ğŸ“šã€Šæ·±å…¥æ¢ç´¢å®‰å“çƒ­ä¿®å¤æŠ€æœ¯åŸç†ã€‹1-32</a></li>
<li><a href="/view/82.html">ğŸ“šã€Šé€†å‘å·¥ç¨‹æƒå¨æŒ‡å—ã€‹ - 1-4ç« </a></li>
    </ul>
 <p>ç¼–ç¨‹å¼€å‘</p>
    <ul>
<li><a href="/view/111.html">ğŸŒ¹ Dobbyä½¿ç”¨</a></li>
<li><a href="/view/77.html">ğŸ“‘ã€å‰ç«¯å¼€å‘ã€‘lightbox+pjaxæœ€ä½³å®è·µ</a></li>
<li><a href="/view/71.html">ğŸ“‘ã€NDKå¼€å‘ã€‘NDKé‡‡é›†ã€å‹ç¼©ã€åŠ å¯†ä¼ è¾“è®¾å¤‡ä¿¡æ¯</a></li>
<li><a href="/view/70.html">ğŸ“‘ã€NDKå¼€å‘ã€‘åŸºç¡€ç¯å¢ƒæ­å»º</a></li>
    </ul>
 <p>é€†å‘åˆ†æ</p>
    <ul>
<li><a href="/view/86.html">âš™ï¸ ã€Xposed æ”¹æœºã€‘- åŸºç¡€ç¯å¢ƒå®‰è£…</a></li>
<li><a href="/view/81.html">ğŸ’» å®‰å“å†…è”æ±‡ç¼–å¼€å‘</a></li>
<li><a href="/view/76.html">ğŸ“‘ JNI ä½¿ç”¨åŸºç¡€</a></li>
<li><a href="/view/75.html">ğŸ“‘ IDA Debugger è°ƒè¯•å™¨ä½¿ç”¨</a></li>
<li><a href="/view/74.html">ğŸ’» std::stringå†…å­˜å¸ƒå±€</a></li>
<li><a href="/view/73.html">ğŸ’¼ Fridaä½œä¸š-20231114</a></li>
<li><a href="/view/65.html">ğŸ§® JSVMPæ‰§è¡Œæµç¨‹åˆ†æ</a></li>
    </ul>


</li>
</ul></div>
</aside><section class="content mx-auto" id="article">
        <div class="d-flex">



            <article class="markdown-section" id="main" style="word-break:break-all;">
                <div>
                <h1>ğŸ§® JSVMPæ‰§è¡Œæµç¨‹åˆ†æ</h1>


                <a style="font-size:12px;color: #5f5d5d;">
                | æ—¶é—´: 2023-10-19 18:41:33| ç›®å½•:é€†å‘åˆ†æ </a>
                |
                <a style="font-size:12px;color: #007bff;" href="http://10.8.0.3:5080/tenantadmin/Tenantarticle/quickedit/quickedit.html?id=118" target="_blank">ç¼–è¾‘æœ¬æ–‡</a>
                <br>


                    <div id="content"><textarea style="display: none;">### ç»“æ„åˆ†æ
è§‚å¯Ÿvmpåå‡½æ•°çš„ç»“æ„,æ ·æœ¬ä»£ç è§æ–‡æœ«ã€‚ï¼ˆæµ‹è¯•åœ°å€ï¼šhttps://rce.ink/vmp.html )

```
function interpreter(parentScope, index, stack, constantPool, bytecode, option={}, args)
```
å‚æ•°é‡Šä¹‰å¦‚ä¸‹ï¼š
parentScopeï¼šä½œç”¨åŸŸï¼Œç”¨äºä¿å­˜æŒ‡ä»¤å¤„ç†åçš„ç»“æœåŠå±æ€§
index:æŒ‡é’ˆï¼Œåˆå§‹ä¸º0
stack:å­˜å€¼çš„æ ˆ
constantPool:å¸¸é‡æ± ï¼Œè·å–å¸¸é‡
bytecode:å­—èŠ‚ç æ•°ç»„ï¼Œç”¨äºæå–opcodeä»¥åŠç›¸åº”çš„æ“ä½œæ•°
option:ç‰¹æ®ŠçŠ¶æ€ä¸‹æœ‰æ•ˆ
args:ç‰¹æ®ŠçŠ¶æ€ä¸‹æœ‰æ•ˆ

æå–å‡ºå­—èŠ‚ç å¦‚ä¸‹ï¼š
```
[3,3,3,4,4,5,12,4,3,0,1,17,0,0,5,3,1,4,6,54,1,12,4,4,0,1,17,0,0,5,4,1,4,7,53,1,5,3,1,4,8,52,1,51,1,13,4,9,0,0,5,9,1,4,10,50,1,7,76,14,74,5,9,1,4,11,54,1,13,4,9,0,0,16,6,76,4,12,4,13,51,1,5,9,1,51,1,12,4,14,1,1,4,15,2,1,0]
```
æå–å‡ºå¸¸é‡æ± å¦‚ä¸‹ï¼š
```
[&#34;@faceless&#34;,&#34;arguments&#34;,&#34;__proto__&#34;,&#34;a&#34;,&#34;b&#34;,22,2,6,4,&#34;c&#34;,70,7,&#34;test&#34;,100,&#34;console&#34;,&#34;log&#34;]
```

æˆ‘ä»¬æ¥è·Ÿè¿›è§‚å¯Ÿä¸€ä¸‹ï¼Œvmpæ˜¯å¦‚ä½•å®ç°è™šæ‹ŸåŒ–ä¿æŠ¤çš„ï¼š
è‡ªè¿è¡Œå‡½æ•°ä¸€å¼€å§‹å®šä¹‰äº†ä¸€ä¸ªlocalScopeç©ºå¯¹è±¡ï¼Œå®šä¹‰@facelessä¸argumentsä¸¤ä¸ªå±æ€§ï¼Œå¹¶ä¿å­˜å‚æ•°ä¸­çš„option ä¸argsï¼Œ åˆ¤æ–­optionä¸­çš„é€‰é¡¹å¼€å…³ï¼Œä»windowå¯¹è±¡ä¸­å–å€¼å¹¶è®¾ç½®åˆ°localScopeä¸­ã€‚å¹¶æŠŠlocalScopeåŸå‹å®šä¹‰ä¸ºwindowå¯¹è±¡,è¿™æ ·å°±å¯ä»¥é€šè¿‡localScopeè°ƒç”¨åˆ°windowå¯¹è±¡ä¸­çš„æ–¹æ³•ã€‚

![](https://p0.meituan.net/xianfu/2d4256e0beb990bc88975b137cb622b847632.png%40watermark=1&&object=L3dkY2Zsb3cvN2RiN2M4NTFjYmVjZDg4MTM1OTZjMTYzOWE2MzQ4MDM0MjY0LnBuZw==&p=8&t=90&x=10&y=10)

å®šä¹‰äº†ä¸€ä¸ªgetScopeçš„æ–¹æ³•ï¼Œç›®çš„æ˜¯åœ¨ç»™å®šçš„ä½œç”¨åŸŸé“¾ä¸­æŸ¥æ‰¾å…·æœ‰æŒ‡å®šåç§°çš„å±æ€§ï¼Œå¹¶è¿”å›æ‹¥æœ‰è¯¥å±æ€§çš„å¯¹è±¡ã€‚å¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™è¿”å› nullã€‚

![](https://p0.meituan.net/xianfu/d74efdd115dde16f0816eefdd244958372967.png%40watermark=1&&object=L3dkY2Zsb3cvN2RiN2M4NTFjYmVjZDg4MTM1OTZjMTYzOWE2MzQ4MDM0MjY0LnBuZw==&p=8&t=90&x=10&y=10)

åé¢å°±è¿›å…¥vmpçš„åˆ†å‘å™¨Dispatcheräº†ã€‚åœ¨htmlé¡µé¢19è¡Œæ‰“ä¸€ä¸ªæ–­ç‚¹ï¼Œè¿™ä»£è¡¨å½“å‰è·å–çš„æŒ‡é’ˆä½ç½®ã€‚

![](https://p0.meituan.net/xianfu/ae5bd41b8ab3f25d6d999b97e38b9ad740440.png%40watermark=1&&object=L3dkY2Zsb3cvN2RiN2M4NTFjYmVjZDg4MTM1OTZjMTYzOWE2MzQ4MDM0MjY0LnBuZw==&p=8&t=90&x=10&y=10)

åˆ·æ–°é¡µé¢

![](https://p0.meituan.net/xianfu/2c25cf1929265421789e3042bec2d056213178.png%40watermark=1&&object=L3dkY2Zsb3cvN2RiN2M4NTFjYmVjZDg4MTM1OTZjMTYzOWE2MzQ4MDM0MjY0LnBuZw==&p=8&t=90&x=10&y=10)

é€šè¿‡æŒ‡é’ˆ0ï¼Œè·å–åˆ°çš„opcodeä¸º3ã€‚å®ƒå°†è¿›å…¥æŸä¸ªåˆ†æ”¯æ‰§è¡Œï¼Œåœ¨ä¸‹é¢æ‰¾åˆ°è¿™ä¸ªé€»è¾‘åˆ¤æ–­ï¼š

![](https://p1.meituan.net/xianfu/b7837063d4ae2797df70bb532d2c10f772682.png%40watermark=1&&object=L3dkY2Zsb3cvN2RiN2M4NTFjYmVjZDg4MTM1OTZjMTYzOWE2MzQ4MDM0MjY0LnBuZw==&p=8&t=90&x=10&y=10)

åœ¨è¿™ä¸ªhandleré‡Œï¼Œä»–å°†æŒ‡é’ˆè‡ªå¢1ï¼Œä¹Ÿå°±æ˜¯1ã€‚åœ¨å­—èŠ‚ç æ•°ç»„ä¸­å‘åå–ä¸€ä½å€¼ï¼Œä¹Ÿå°±æ˜¯3ï¼Œè¿™ä¸ªå€¼å°†ä½œä¸ºå¸¸é‡æ± ä¸­çš„ç´¢å¼•ã€‚å¹¶å°†t1èµ‹å€¼ä¸ºå¸¸é‡æ± ä¸­çš„aï¼Œå¹¶æŠŠlocalscopeå®šä¹‰ä¸€ä¸ªå±æ€§aï¼Œå€¼ä¸ºundefinedã€‚

æ€»ç»“ä¸€ä¸‹

| opcode  |  ç”¨é€” |
| ------------ | ------------ |
|  3 | å˜é‡å®šä¹‰ï¼Œç±»ä¼¼äº var xx = undefind  |

å»æ‰è¿™é‡Œçš„æ–­ç‚¹ï¼Œç»§ç»­å‘ä¸‹è·Ÿè¿›ã€‚

![](https://p1.meituan.net/xianfu/6535f8ad016768b9a46dab09a12e169e83968.png%40watermark=1&&object=L3dkY2Zsb3cvN2RiN2M4NTFjYmVjZDg4MTM1OTZjMTYzOWE2MzQ4MDM0MjY0LnBuZw==&p=8&t=90&x=10&y=10)

è¿™é‡Œçš„opcodeè¿˜æ˜¯3ï¼Œå‰é¢çš„æµç¨‹åšçš„äº‹åŸå§‹ä»£ç ä¸­çš„var açš„éƒ¨åˆ†ï¼Œå¤§èƒ†çŒœæµ‹è¿™é‡Œåšçš„äº‹var bçš„æ“ä½œã€‚

![](https://p0.meituan.net/xianfu/02d88ead445303e834cc8ed6fd82900e63956.png%40watermark=1&&object=L3dkY2Zsb3cvN2RiN2M4NTFjYmVjZDg4MTM1OTZjMTYzOWE2MzQ4MDM0MjY0LnBuZw==&p=8&t=90&x=10&y=10)

æŒ‡é’ˆç»§ç»­è‡ªå¢1ï¼Œå–åˆ°å¸¸é‡æ± ä¸­çš„bã€‚ä¹ŸåŒæ ·èµ‹å€¼ç»™localScopeã€‚


![](https://p0.meituan.net/xianfu/87c80b156880958df571211398af123183438.png%40watermark=1&&object=L3dkY2Zsb3cvN2RiN2M4NTFjYmVjZDg4MTM1OTZjMTYzOWE2MzQ4MDM0MjY0LnBuZw==&p=8&t=90&x=10&y=10)

ä¹‹åopcodeå°±å˜æˆ4äº†ï¼Œå‘ä¸‹è·Ÿè¿›å‘ç°å®ƒå…ˆæŒ‡é’ˆè‡ªå¢å–å­—èŠ‚ç ï¼Œç„¶åä»å¸¸é‡æ± ä¸­å–è¿™ä¸ªç´¢å¼•çš„å€¼å¹¶å‹å…¥æ ˆä¸­ã€‚

![](https://p0.meituan.net/xianfu/edca00df5c3922424f217b47e20e5db150835.png%40watermark=1&&object=L3dkY2Zsb3cvN2RiN2M4NTFjYmVjZDg4MTM1OTZjMTYzOWE2MzQ4MDM0MjY0LnBuZw==&p=8&t=90&x=10&y=10)

| opcode  |  ç”¨é€” |
| ------------ | ------------ |
|  3 | å˜é‡å®šä¹‰ï¼Œç±»ä¼¼äº var xx = undefind  |
|4 |æ ¹æ®æ“ä½œæ•°ï¼Œä»å¸¸é‡æ± å–å€¼ï¼Œå‹å…¥æ ˆ|

ç»§ç»­å¾€ä¸‹ï¼Œå‘ç°opcodeæ˜¯12äº†

![](https://p0.meituan.net/xianfu/213e8975e982a00825c4233de973c8fa129769.png%40watermark=1&&object=L3dkY2Zsb3cvN2RiN2M4NTFjYmVjZDg4MTM1OTZjMTYzOWE2MzQ4MDM0MjY0LnBuZw==&p=8&t=90&x=10&y=10)

æ‰¾åˆ°å¯¹åº”çš„handler

![](https://p0.meituan.net/xianfu/f8e994a0a56522280bf067c0d4bcaf8219935.png%40watermark=1&&object=L3dkY2Zsb3cvN2RiN2M4NTFjYmVjZDg4MTM1OTZjMTYzOWE2MzQ4MDM0MjY0LnBuZw==&p=8&t=90&x=10&y=10)

å‘ç°æ˜¯æŠŠå½“å‰çš„æœ¬åœ°ä½œç”¨åŸŸæ”¾å…¥æ ˆä¸­


| opcode  |  ç”¨é€” |
| ------------ | ------------ |
|  3 | å˜é‡å®šä¹‰ï¼Œç±»ä¼¼äº var xx = undefind  |
|4 |æ ¹æ®æ“ä½œæ•°ï¼Œä»å¸¸é‡æ± å–å€¼ï¼Œå‹å…¥æ ˆ|
|12 |å°†å½“å‰çš„localScopeå‹å…¥æ ˆ|

æ¥ç€å¾€ä¸‹è·Ÿè¿›ï¼Œopcodeåˆä¸º4
![](https://p0.meituan.net/xianfu/56f7b05dadf516e6070d8985373f8bad68605.png%40watermark=1&&object=L3dkY2Zsb3cvN2RiN2M4NTFjYmVjZDg4MTM1OTZjMTYzOWE2MzQ4MDM0MjY0LnBuZw==&p=8&t=90&x=10&y=10)
å¾€åå–æ“ä½œæ•°,æ˜¯ç”¨è¿™ä¸ªå€¼ä½œä¸ºå¸¸é‡æ± æ•°ç»„ç´¢å¼•å–å€¼

![](https://p0.meituan.net/xianfu/97d45841bbdbecb61d85ae5735fd2d6f55206.png%40watermark=1&&object=L3dkY2Zsb3cvN2RiN2M4NTFjYmVjZDg4MTM1OTZjMTYzOWE2MzQ4MDM0MjY0LnBuZw==&p=8&t=90&x=10&y=10)

å¯ä»¥å‘ç°æ­¤æ—¶æ ˆä¸­å­˜åœ¨22ã€windowã€aä¸‰ä¸ªå€¼ã€‚æˆ‘ä»¬å¯ä»¥æ•´ç†å½’çº³ä¸€ä¸‹ï¼Œå‰é¢å­—èŠ‚ç åšäº†å“ªäº›äº‹ï¼š

3,3   å®šä¹‰å˜é‡a
3,4   å®šä¹‰å˜é‡b
4,5   å–äº†åŸå§‹ä»£ç ä¸­çš„açš„å€¼ æ”¾å…¥æ ˆä¸­
12    å°†localScopeæ”¾å…¥æ ˆä¸­
4,3,  å–äº†aè¿™ä¸ªå˜é‡å æ”¾å…¥æ ˆä¸­

è¿™é‡Œå…¶å®æœ‰ç‚¹æ„Ÿè§‰äº†ï¼Œä¸‰ä¸ªå€¼æ”¾å…¥æ ˆä¸­ï¼Œä¸€ä¸ªå€¼ä¸ºwindowå¯¹è±¡ï¼Œä¸€ä¸ªå±æ€§åä¸€ä¸ªå±æ€§å€¼ï¼Œå¤§æ¦‚ç‡åé¢çš„opcodeè¦åšå€¼å‡ºæ ˆï¼Œèµ‹å€¼çš„ä½œç”¨ã€‚ç±»ä¼¼å¼¹å‡ºaå’Œwindowï¼Œç„¶ååšç±»ä¼¼window.a  = 22 ã€‚å°è¯ä¸€ä¸‹æ¥ç€å¾€ä¸‹å§ï¼š

![](https://p0.meituan.net/xianfu/708ae137a5e35c089a88f6c45116dca874402.png%40watermark=1&&object=L3dkY2Zsb3cvN2RiN2M4NTFjYmVjZDg4MTM1OTZjMTYzOWE2MzQ4MDM0MjY0LnBuZw==&p=8&t=90&x=10&y=10)

![](https://p1.meituan.net/xianfu/96ac09b08580854b0d54843b5fb0a1db54095.png%40watermark=1&&object=L3dkY2Zsb3cvN2RiN2M4NTFjYmVjZDg4MTM1OTZjMTYzOWE2MzQ4MDM0MjY0LnBuZw==&p=8&t=90&x=10&y=10)

è¿™é‡Œçš„é€»è¾‘å°±å¾ˆæ¸…æ™°äº†ï¼Œå¼¹å‡ºä¸‰ä¸ªå…ƒç´ ï¼Œåˆ†åˆ«ä¸ºå±æ€§åaã€windowå¯¹è±¡ã€å€¼22ï¼Œç„¶åå‘ä¸‹æ‰¾ä¸€ä¸ªæ“ä½œæ•°ï¼Œæ­¤æ—¶ä¸º1ã€‚é€šè¿‡getScopeå‡½æ•°è·å–å­˜åœ¨å±æ€§açš„ä½œç”¨åŸŸï¼Œå› ä¸ºå‰é¢localScopeå®šä¹‰è¿‡açš„å±æ€§ï¼ˆé€šè¿‡opecode=3çš„ç¬¬ä¸€æ¬¡æ“ä½œï¼‰ï¼Œæ‰€ä»¥ä¼šè¿”å›ä½œç”¨åŸŸlocalScopeï¼Œå¹¶æŠŠè¿™ä¸ªä½œç”¨åŸŸçš„å±æ€§aèµ‹å€¼22ã€‚ç”±äºæ“ä½œæ•°t4ä¸º1ï¼Œéœ€è¦æŠŠè¿™ä¸ªå€¼å‹å›æ ˆå†…ã€‚

![](https://p0.meituan.net/xianfu/cb5c5a322a04126a069ef03a4e342d6b122057.png%40watermark=1&&object=L3dkY2Zsb3cvN2RiN2M4NTFjYmVjZDg4MTM1OTZjMTYzOWE2MzQ4MDM0MjY0LnBuZw==&p=8&t=90&x=10&y=10)

| opcode  |  ç”¨é€” |
| ------------ | ------------ |
|  3 | å˜é‡å®šä¹‰ï¼Œç±»ä¼¼äº var xx = undefind  |
|4 |æ ¹æ®æ“ä½œæ•°ï¼Œä»å¸¸é‡æ± å–å€¼ï¼Œå‹å…¥æ ˆ|
|12 |å°†å½“å‰çš„localScopeå‹å…¥æ ˆ|
|0 |å¼¹å‡ºæ ˆé¡¶çš„ä¸‰ä¸ªå…ƒç´ ï¼Œæ‰¾åˆ°å­˜åœ¨æ ˆé¡¶å…ƒç´ åå±æ€§çš„ä½œç”¨åŸŸï¼Œè®¾ç½®è¿™ä¸ªå±æ€§çš„å€¼ä¸ºç¬¬ä¸‰ä¸ªå…ƒç´ çš„å€¼ï¼Œæœ€åæŠŠå€¼å‹å›æ ˆå†…|

3,3   å®šä¹‰å˜é‡a
3,4   å®šä¹‰å˜é‡b
4,5   å–äº†åŸå§‹ä»£ç ä¸­çš„açš„å€¼ æ”¾å…¥æ ˆä¸­
12    å°†localScopeæ”¾å…¥æ ˆä¸­
4,3,  å–äº†aè¿™ä¸ªå˜é‡å æ”¾å…¥æ ˆä¸­
0,1  localScope èµ‹å€¼ï¼Œå°†èµ‹çš„å€¼æ”¾å…¥æ ˆä¸­

æ­¤æ—¶é€šè¿‡6æ¡æŒ‡ä»¤ï¼Œ12ä¸ªå­—èŠ‚ç ï¼Œæˆ‘ä»¬å®ç°äº†åŸå§‹ä»£ç ä¸­çš„var a =22çš„æ•ˆæœã€‚

æ¥ç€å¾€ä¸‹çœ‹åˆ«çš„opcode

![](https://p0.meituan.net/xianfu/243ed710beb6b51e8ac3f15a3880ee2350246.png%40watermark=1&&object=L3dkY2Zsb3cvN2RiN2M4NTFjYmVjZDg4MTM1OTZjMTYzOWE2MzQ4MDM0MjY0LnBuZw==&p=8&t=90&x=10&y=10)

å–å‡ºæ ˆé¡¶å…ƒç´ ï¼Œå¾€ä¸‹å–æ“ä½œæ•°ä¸º0ï¼Œå°†æ­¤å€¼ä½œä¸ºå¼¹å‡ºå…ƒç´ çš„æ•°é‡ï¼Œå¯¹æ ˆé¡¶è¿›è¡Œæ¸…ç†çš„æ“ä½œã€‚å†å¾€ä¸‹å–æ“ä½œæ•°t5ï¼Œåˆ¤æ–­æ˜¯å¦è¦æŠŠå‰é¢æ ˆé¡¶çš„å€¼æ”¾å›ã€‚

![](https://p0.meituan.net/xianfu/d3397176f8f241d6ff99d21badfadfcb74482.png%40watermark=1&&object=L3dkY2Zsb3cvN2RiN2M4NTFjYmVjZDg4MTM1OTZjMTYzOWE2MzQ4MDM0MjY0LnBuZw==&p=8&t=90&x=10&y=10)

å¯ä»¥çœ‹åˆ°æ ˆæ­¤æ—¶è¢«æ¸…ç©ºäº†ã€‚

3,3   å®šä¹‰å˜é‡a
3,4   å®šä¹‰å˜é‡b
4,5   å–äº†åŸå§‹ä»£ç ä¸­çš„açš„å€¼ æ”¾å…¥æ ˆä¸­
12    å°†localScopeæ”¾å…¥æ ˆä¸­
4,3,  å–äº†aè¿™ä¸ªå˜é‡å æ”¾å…¥æ ˆä¸­
0,1  localScope èµ‹å€¼ï¼Œå°†èµ‹çš„å€¼æ”¾å…¥æ ˆä¸­
17,0,0 å¼¹å‡ºæ ˆé¡¶ï¼Œæ¸…ç©º0ä¸ªæ ˆä¸Šå…ƒç´ ï¼Œä¸æŠŠå¼¹å‡ºçš„å€¼å‹å›æ ˆå†…

| opcode  |  ç”¨é€” |
| ------------ | ------------ |
|  3 | å˜é‡å®šä¹‰ï¼Œç±»ä¼¼äº var xx = undefind  |
|4 |æ ¹æ®æ“ä½œæ•°ï¼Œä»å¸¸é‡æ± å–å€¼ï¼Œå‹å…¥æ ˆ|
|12 |å°†å½“å‰çš„localScopeå‹å…¥æ ˆ|
|0 |å¼¹å‡ºæ ˆé¡¶çš„ä¸‰ä¸ªå…ƒç´ ï¼Œæ‰¾åˆ°å­˜åœ¨æ ˆé¡¶å…ƒç´ åå±æ€§çš„ä½œç”¨åŸŸï¼Œè®¾ç½®è¿™ä¸ªå±æ€§çš„å€¼ä¸ºç¬¬ä¸‰ä¸ªå…ƒç´ çš„å€¼ï¼Œæœ€åæŠŠå€¼å‹å›æ ˆå†…|
|17 |å¼¹å‡ºæ ˆé¡¶å…ƒç´ ï¼Œæ ¹æ®ç¬¬ä¸€ä¸ªæ“ä½œæ•°åˆ¤æ–­éœ€è¦æ¸…ç©ºçš„æ ˆå†…å…ƒç´ çš„ä¸ªæ•°ï¼Œç¬¬äºŒä¸ªæ“ä½œæ•°åˆ¤æ–­æ˜¯å¦æŠŠå€¼å‹å›æ ˆå†…|

opcodeä¸º0æ—¶ï¼Œèµ‹å€¼ç»“æŸä¸ç¡®å®šåç»­æ˜¯å¦è¦ä»æ ˆè·å–è¿™ä¸ªå€¼ï¼Œæ‰€ä»¥ä¼šå°†è¿™ä¸ªå€¼é‡æ–°å‹å…¥æ ˆä¸­ã€‚
ä¸º17æ—¶ï¼Œæ ¹æ®æ“ä½œæ•°æ˜¯å¦æ¸…ç©ºæ ˆã€‚æˆ–è€…ä»…ä¿ç•™æ ˆé¡¶å…ƒç´ ã€‚

å‘ä¸‹è·Ÿè¿›ï¼Œopcodeä¸º5ã€‚

![](https://p0.meituan.net/xianfu/d577e47d445183c968143d952e1b81e897097.png%40watermark=1&&object=L3dkY2Zsb3cvN2RiN2M4NTFjYmVjZDg4MTM1OTZjMTYzOWE2MzQ4MDM0MjY0LnBuZw==&p=8&t=90&x=10&y=10)

ç¬¬ä¸€ä¸ªæ“ä½œæ•°ç”¨äºåœ¨å¸¸é‡æ± è·å–å±æ€§åï¼Œç¬¬äºŒä¸ªæ“ä½œæ•°ç”¨äºåˆ¤æ–­æ˜¯å¦å‹å…¥æ ˆå†…ã€‚æ­¤æ—¶å°†ä½œç”¨åŸŸä¸­çš„açš„å€¼å‹å…¥äº†æ ˆå†…ã€‚

| opcode  |  ç”¨é€” |
| ------------ | ------------ |
|  3 | å˜é‡å®šä¹‰ï¼Œç±»ä¼¼äº var xx = undefind  |
|4 |æ ¹æ®æ“ä½œæ•°ï¼Œä»å¸¸é‡æ± å–å€¼ï¼Œå‹å…¥æ ˆ|
|12 |å°†å½“å‰çš„localScopeå‹å…¥æ ˆ|
|0 |å¼¹å‡ºæ ˆé¡¶çš„ä¸‰ä¸ªå…ƒç´ ï¼Œæ‰¾åˆ°å­˜åœ¨æ ˆé¡¶å…ƒç´ åå±æ€§çš„ä½œç”¨åŸŸï¼Œè®¾ç½®è¿™ä¸ªå±æ€§çš„å€¼ä¸ºç¬¬ä¸‰ä¸ªå…ƒç´ çš„å€¼ï¼Œæœ€åæŠŠå€¼å‹å›æ ˆå†…|
|17 |å¼¹å‡ºæ ˆé¡¶å…ƒç´ ï¼Œæ ¹æ®ç¬¬ä¸€ä¸ªæ“ä½œæ•°åˆ¤æ–­éœ€è¦æ¸…ç©ºçš„æ ˆå†…å…ƒç´ çš„ä¸ªæ•°ï¼Œç¬¬äºŒä¸ªæ“ä½œæ•°åˆ¤æ–­æ˜¯å¦æŠŠå€¼å‹å›æ ˆå†…|
|5|æ ¹æ®ç¬¬ä¸€ä¸ªæ“ä½œæ•°æ‹¿åˆ°å±æ€§åï¼Œå–å€¼åæ ¹æ®ç¬¬äºŒä¸ªæ“ä½œæ•°åˆ¤æ–­æ˜¯å¦å‹å…¥æ ˆå†…|

3,3   å®šä¹‰å˜é‡a
3,4   å®šä¹‰å˜é‡b
4,5   å–äº†åŸå§‹ä»£ç ä¸­çš„açš„å€¼ æ”¾å…¥æ ˆä¸­
12    å°†localScopeæ”¾å…¥æ ˆä¸­
4,3,  å–äº†aè¿™ä¸ªå˜é‡å æ”¾å…¥æ ˆä¸­
0,1  localScope èµ‹å€¼ï¼Œå°†èµ‹çš„å€¼æ”¾å…¥æ ˆä¸­
17,0,0 å¼¹å‡ºæ ˆé¡¶ï¼Œæ¸…ç©º0ä¸ªæ ˆä¸Šå…ƒç´ ï¼Œä¸æŠŠå¼¹å‡ºçš„å€¼å‹å›æ ˆå†…
5,4,1 å–å¸¸é‡æ± ä¸­ç¬¬å››ä¸ªå€¼ä½œä¸ºå±æ€§åï¼Œè·å–ä½œç”¨åŸŸä¸­è¯¥å±æ€§çš„å€¼å¹¶å‹å…¥æ ˆå†…

åé¢åˆ°äº†opcodeä¸º4çš„ä½ç½®ï¼Œå°†2çš„å€¼å‹å…¥æ ˆå†…ã€‚æ­¤æ—¶æ ˆåˆ†å¸ƒ

![](https://p1.meituan.net/xianfu/bc9639b1bc16f58ec4373fde4e546a8010433.png%40watermark=1&&object=L3dkY2Zsb3cvN2RiN2M4NTFjYmVjZDg4MTM1OTZjMTYzOWE2MzQ4MDM0MjY0LnBuZw==&p=8&t=90&x=10&y=10)

å†åˆ°opcodeä¸º54çš„æ“ä½œäº†ï¼Œè¿™é‡Œç¨å¾®éº»çƒ¦ç‚¹ï¼š

å…ˆè¿›å…¥ä¸€ä¸ªæŒ‡ä»¤èŒƒå›´çš„åˆ¤æ–­ï¼ŒæŠŠæ ˆå†…ä¸¤ä¸ªå…ƒç´ å¼¹å‡ºã€‚ï¼ˆå¯ä»¥æƒ³åˆ°è¿™æ®µèŒƒå›´çš„opcodeå®ç°äº†å¯¹æ ˆå†…ä¸¤ä¸ªå…ƒç´ çš„å„ç±»è¿ç®—ï¼‰

![](https://p0.meituan.net/xianfu/a244244d6aad0c36343664a4571277c232175.png%40watermark=1&&object=L3dkY2Zsb3cvN2RiN2M4NTFjYmVjZDg4MTM1OTZjMTYzOWE2MzQ4MDM0MjY0LnBuZw==&p=8&t=90&x=10&y=10)

å†è¿›å…¥è¿™ä¸ªåˆ†æ”¯è¿›è¡Œé™¤è¿ç®—

![](https://p0.meituan.net/xianfu/110ae171161ff47698dc9bb31e05228814159.png%40watermark=1&&object=L3dkY2Zsb3cvN2RiN2M4NTFjYmVjZDg4MTM1OTZjMTYzOWE2MzQ4MDM0MjY0LnBuZw==&p=8&t=90&x=10&y=10)

è¿™ä¸å°±æ˜¯åŸå§‹ä»£ç ä¸­çš„ a/2çš„éƒ¨åˆ†å—ã€‚å†å–æ“ä½œæ•°åˆ¤æ–­æ˜¯å¦è¦å‹å›æ ˆå†…,æœ€ç»ˆæŠŠé™¤åçš„ç»“æœå‹å…¥æ ˆå†…ï¼š

![](https://p0.meituan.net/xianfu/ce99ad13d9bc643a2955db414b27933537439.png%40watermark=1&&object=L3dkY2Zsb3cvN2RiN2M4NTFjYmVjZDg4MTM1OTZjMTYzOWE2MzQ4MDM0MjY0LnBuZw==&p=8&t=90&x=10&y=10)

| opcode  |  ç”¨é€” |
| ------------ | ------------ |
|  3 | å˜é‡å®šä¹‰ï¼Œç±»ä¼¼äº var xx = undefind  |
|4 |æ ¹æ®æ“ä½œæ•°ï¼Œä»å¸¸é‡æ± å–å€¼ï¼Œå‹å…¥æ ˆ|
|12 |å°†å½“å‰çš„localScopeå‹å…¥æ ˆ|
|0 |å¼¹å‡ºæ ˆé¡¶çš„ä¸‰ä¸ªå…ƒç´ ï¼Œæ‰¾åˆ°å­˜åœ¨æ ˆé¡¶å…ƒç´ åå±æ€§çš„ä½œç”¨åŸŸï¼Œè®¾ç½®è¿™ä¸ªå±æ€§çš„å€¼ä¸ºç¬¬ä¸‰ä¸ªå…ƒç´ çš„å€¼ï¼Œæœ€åæŠŠå€¼å‹å›æ ˆå†…|
|17 |å¼¹å‡ºæ ˆé¡¶å…ƒç´ ï¼Œæ ¹æ®ç¬¬ä¸€ä¸ªæ“ä½œæ•°åˆ¤æ–­éœ€è¦æ¸…ç©ºçš„æ ˆå†…å…ƒç´ çš„ä¸ªæ•°ï¼Œç¬¬äºŒä¸ªæ“ä½œæ•°åˆ¤æ–­æ˜¯å¦æŠŠå€¼å‹å›æ ˆå†…|
|5|æ ¹æ®ç¬¬ä¸€ä¸ªæ“ä½œæ•°æ‹¿åˆ°å±æ€§åï¼Œå–å€¼åæ ¹æ®ç¬¬äºŒä¸ªæ“ä½œæ•°åˆ¤æ–­æ˜¯å¦å‹å…¥æ ˆå†…|
|54|å–æ ˆé¡¶ä¸¤ä¸ªå…ƒç´ å¼¹å‡ºï¼Œè¿›è¡Œé™¤æ“ä½œï¼Œç»“æœæ ¹æ®æ“ä½œæ•°åˆ¤æ–­æ˜¯å¦å‹å…¥æ ˆå†…|

åé¢åˆåˆ°äº†opcodeä¸º12ï¼ŒæŠŠlocalscopeå‹å…¥æ ˆï¼Œç•¥è¿‡ã€‚
åˆåˆ°äº†opcodeä¸º4ï¼Œè·Ÿæ®æ“ä½œæ•°æŠŠbå‹å…¥æ ˆå†…ã€‚
éšåå°±æ˜¯0äº†ï¼Œæ­¤æ—¶æ ˆå†…åˆ†å¸ƒï¼š

![](https://p0.meituan.net/xianfu/456c423a2bd04f5b342023d04c1769bd10367.png%40watermark=1&&object=L3dkY2Zsb3cvN2RiN2M4NTFjYmVjZDg4MTM1OTZjMTYzOWE2MzQ4MDM0MjY0LnBuZw==&p=8&t=90&x=10&y=10)

å¾ˆæ˜¾ç„¶åšäº†åŒæ ·çš„æ­¥éª¤ï¼ŒæŠŠlocalscopeä¸­çš„bå±æ€§èµ‹å€¼ä¸º11ã€‚é¢„æµ‹ä¸‹ä¸€æ¡æŒ‡ä»¤å¿…å®šæ˜¯17ä»¥æ¸…ç©ºæ ˆã€‚

![](https://p0.meituan.net/xianfu/dea8a98bdc9b8b9e85c439a0aa4e466175394.png%40watermark=1&&object=L3dkY2Zsb3cvN2RiN2M4NTFjYmVjZDg4MTM1OTZjMTYzOWE2MzQ4MDM0MjY0LnBuZw==&p=8&t=90&x=10&y=10)

ç»“æœçœŸå¦‚é¢„æƒ³çš„ä¸€æ ·ã€‚åé¢çš„æ­¥éª¤ï¼Œè¿›è¡Œç®€åŒ–ï¼š

5 -&gt; å°†bçš„å€¼å‹å…¥æ ˆ
4 -&gt; å°†å¸¸é‡æ± 6å‹å…¥æ ˆ
53 -&gt; å¼¹å‡ºä¸¤ä¸ªå…ƒç´ ï¼Œè¿›è¡Œä¹˜æ³•æ“ä½œï¼Œç»“æœå‹å…¥æ ˆ
5 -&gt; å°†açš„å€¼ å‹å…¥æ ˆ
4 -&gt; å°†å¸¸é‡4å‹å…¥æ ˆ
52 -&gt; å¼¹å‡ºæ ˆé¡¶ä¸¤ä¸ªå…ƒç´  è¿›è¡Œå‡æ³•æ“ä½œï¼Œç»“æœå‹å…¥æ ˆ

ï¼ˆstopï¼Œæ­¤æ—¶æ ˆå†…å­˜æ”¾ç€b*6çš„å€¼ä¸a-4çš„å€¼ï¼Œä¸å‡ºæ‰€æ–™åé¢å¿…å®šæ˜¯è¿›è¡ŒåŠ æ“ä½œï¼‰
![](https://p0.meituan.net/xianfu/e2ebacdd944572d1701a3f262efc0d1964919.png%40watermark=1&&object=L3dkY2Zsb3cvN2RiN2M4NTFjYmVjZDg4MTM1OTZjMTYzOWE2MzQ4MDM0MjY0LnBuZw==&p=8&t=90&x=10&y=10)

æ­¤æ—¶æ ˆå†…å­˜æ”¾ç€ (b*6)&#43;(a-4)çš„ç»“æœå€¼ï¼Œæ¥ç€æ˜¯éœ€è¦èµ‹å€¼ç»™cçš„ã€‚ä½†æ˜¯å’Œabæœ‰åŒºåˆ«ï¼Œä»–å¹¶ä¸æ˜¯varå®šä¹‰çš„å€¼ï¼Œè€Œæ˜¯ç›´æ¥èµ‹å€¼ã€‚åœ¨jsçš„èµ‹å€¼æ“ä½œä¸­ï¼Œä»–æ˜¯ç›´æ¥æˆä¸ºwindowçš„ä¸€ä¸ªå±æ€§çš„ï¼š
![](https://p0.meituan.net/xianfu/ea4a028f885a4c89836bfc07d9fa1ce812279.png%40watermark=1&&object=L3dkY2Zsb3cvN2RiN2M4NTFjYmVjZDg4MTM1OTZjMTYzOWE2MzQ4MDM0MjY0LnBuZw==&p=8&t=90&x=10&y=10)

æˆ‘ä»¬æ¥é¢„æµ‹ä¸€ä¸‹æŒ‡ä»¤å§ï¼Œå…ˆæŠŠwindowä½œç”¨åŸŸæ”¾åˆ°æ ˆå†…ï¼Œå†ä»å¸¸é‡æ± å–cè¿™ä¸ªå±æ€§åæ”¾å…¥æ ˆå†…ï¼Œæœ€åè¿›è¡Œèµ‹å€¼æ“ä½œï¼Œé¡ºåºåº”è¯¥æ˜¯ï¼š

![](https://p0.meituan.net/xianfu/d36fb076b5986972d77587058114b20e20625.png%40watermark=1&&object=L3dkY2Zsb3cvN2RiN2M4NTFjYmVjZDg4MTM1OTZjMTYzOWE2MzQ4MDM0MjY0LnBuZw==&p=8&t=90&x=10&y=10)

13ï¼ˆé€šè¿‡ä»£ç é˜…è¯»ç›´æ¥æ‰¾åˆ°opcodeï¼‰
4
0

çœ‹ä¸‹ç»“æœå§ã€‚

![](https://p0.meituan.net/xianfu/ba0667d78b4a422788e7f270ea4e32f163735.png%40watermark=1&&object=L3dkY2Zsb3cvN2RiN2M4NTFjYmVjZDg4MTM1OTZjMTYzOWE2MzQ4MDM0MjY0LnBuZw==&p=8&t=90&x=10&y=10)

![](https://p0.meituan.net/xianfu/a1900ad206c57f4c453e5e140672376564164.png%40watermark=1&&object=L3dkY2Zsb3cvN2RiN2M4NTFjYmVjZDg4MTM1OTZjMTYzOWE2MzQ4MDM0MjY0LnBuZw==&p=8&t=90&x=10&y=10)

![](https://p0.meituan.net/xianfu/1a4f5eccfa40bca6c6f619bed62277d376551.png%40watermark=1&&object=L3dkY2Zsb3cvN2RiN2M4NTFjYmVjZDg4MTM1OTZjMTYzOWE2MzQ4MDM0MjY0LnBuZw==&p=8&t=90&x=10&y=10)

å®Œå…¨æ­£ç¡®ã€‚æ­¤æ—¶å·²ç»èµ‹å€¼äº†cåœ¨windowå±æ€§ä¸­ï¼Œä¸‹ä¸€æ¡æŒ‡ä»¤çš„opcodeä¸º5ï¼Œæ ¹æ®æ“ä½œæ•°æ‹¿åˆ°äº†cè¿™ä¸ªå€¼å¹¶å‹å…¥æ ˆå†…ã€‚ï¼ˆè™½ç„¶cå®šä¹‰åœ¨windowä¸­ï¼Œä½†æ˜¯localScopeçš„åŸå‹æŒ‡å‘äº†windowï¼Œæ‰€ä»¥æŒ‰ç…§æŸ¥æ‰¾æœºåˆ¶ä¹Ÿå¯ä»¥é€šè¿‡localScope.cå–åˆ°cçš„å€¼ã€‚è¿™ä¹Ÿå°±æ˜¯ä¸€å¼€å§‹åˆå§‹åŒ–çš„æ—¶å€™ä¸ºä»€ä¹ˆéœ€è¦é‚£æ ·å®šä¹‰ã€‚ï¼‰

ä¹‹åçš„opcodeä¸º4ï¼Œæ ¹æ®è¡¨æ¨æµ‹ï¼Œå°†å¸¸é‡æ± ä¸­çš„70å‹å…¥æ ˆå†…ï¼Œå³å°†ä¸cçš„å€¼åšæ¯”è¾ƒã€‚
ä¹‹åçš„opcodeä¸º50ï¼Œæ˜¯ä¸€ä¸ªæ¯”è¾ƒè¿ç®—

![](https://p0.meituan.net/xianfu/0c6e25ff584658a460f66970da7081ba25264.png%40watermark=1&&object=L3dkY2Zsb3cvN2RiN2M4NTFjYmVjZDg4MTM1OTZjMTYzOWE2MzQ4MDM0MjY0LnBuZw==&p=8&t=90&x=10&y=10)

è¿ç®—ç»“æŸåï¼Œæ ˆå†…å­˜åœ¨ä¸€ä¸ªå¸ƒå°”å€¼

![](https://p1.meituan.net/xianfu/a7e9be38469a7e407fe5e91c972383548689.png%40watermark=1&&object=L3dkY2Zsb3cvN2RiN2M4NTFjYmVjZDg4MTM1OTZjMTYzOWE2MzQ4MDM0MjY0LnBuZw==&p=8&t=90&x=10&y=10)

å¾€åçš„æ“ä½œç ä¸º7ï¼Œå¦‚æœæ ˆå†…å…ƒç´ ä¸ºfalseï¼Œåˆ™ä¿®æ”¹ç´¢å¼•å€¼ä¸ºç¬¬ä¸€ä¸ªæ“ä½œæ•°ã€‚è¿™é‡Œä¸ºtrueï¼Œæ‰€ä»¥æ²¡æœ‰è·³è½¬ã€‚æœ‰æ²¡æœ‰æœ‰ç‚¹åƒï¼Œå¦‚æœæ˜¯falseè¿›å…¥elseåˆ†æ”¯ï¼Œè·³è¿‡ifé€»è¾‘ç›´æ¥è¿›å…¥elseçš„åˆ†æ”¯èµ·å§‹æŒ‡é’ˆï¼Ÿ

![](https://p0.meituan.net/xianfu/85763aed1429c9e1d13ccde45fb51e3031733.png%40watermark=1&&object=L3dkY2Zsb3cvN2RiN2M4NTFjYmVjZDg4MTM1OTZjMTYzOWE2MzQ4MDM0MjY0LnBuZw==&p=8&t=90&x=10&y=10)

opcodeä¸º14, è¿™åº”è¯¥æ˜¯æ‰€æœ‰æŒ‡ä»¤ä¸­æœ€éš¾ç†è§£çš„äº†ã€‚

è¿™æ¡æŒ‡ä»¤åˆ†æˆå‡ éƒ¨åˆ†ï¼š

|  opcode | æ“ä½œæ•°1  | body  | æ“ä½œæ•°2  |
| ------------ | ------------ | ------------ | ------------ |
| 14  | è·³è½¬ä½ç½®   |  æŒ‡ä»¤é›† | 16  |

è¿›å…¥14æ—¶ï¼Œå°†æŒ‡ä»¤é›†ç”¨åˆ†å‘å™¨å†æ‰§è¡Œä¸€éï¼Œå¹¶æŠŠç»“æœå­˜å‚¨åˆ°ä½œç”¨åŸŸã€‚ç›´åˆ°é‡åˆ°opcode16è·³å‡ºã€‚
åœ¨æŠ½è±¡è¯­æ³•æ ‘ä¸­ï¼ŒæŒ‰ç…§æ·±åº¦ä¼˜å…ˆçš„é€»è¾‘ï¼Œé‡åˆ°ifstatementæ—¶ï¼Œä¼šæ‰§è¡Œpushï¼ˆ14ï¼‰-&gt;å¯¹å­å—ç»§ç»­åšå­—èŠ‚ç è½¬æ¢-&gt;æ‰§è¡Œpush(16)ç»“æŸè¿™ä¸ªstatementã€‚

![](https://p0.meituan.net/xianfu/0b5b1cfd99b0e94010cd7fb2d75b707976626.png%40watermark=1&&object=L3dkY2Zsb3cvN2RiN2M4NTFjYmVjZDg4MTM1OTZjMTYzOWE2MzQ4MDM0MjY0LnBuZw==&p=8&t=90&x=10&y=10)

è‡³æ­¤ å¯¹jsvmpæœ‰åŸºæœ¬çš„è®¤çŸ¥å³å¯ã€‚åç»­ä¼šç»§ç»­å­¦ä¹ ç›¸åº”çš„å¼€å‘ä»¥åŠå¯¹æŠ—vmpçš„ä¸€äº›æ¢ç´¢ã€‚

### åŸå§‹ä»£ç 
```javascript
var a = 22
var b =  a/2
c = (b*6)&#43;(a-4)
if(c&gt;70){
  c = c/7
}
console.log(&#34;test&#34;&#43;100&#43;c)
```
### æ ·æœ¬ä»£ç 
````javascript
(function interpreter(parentScope, index, stack, constantPool, bytecode, option = {}, args) {
  let localScope = {};
  localScope[constantPool[0]] = option.t || this;
  localScope[constantPool[1]] = args;
  if (option.n) localScope[option.n] = parentScope[option.f];
  localScope.__proto__ = parentScope;
  function getScope(scope, name) {
    if (!scope || name == constantPool[2]) return null;
    if (scope.hasOwnProperty(name)) return scope;
    return getScope(Object.getPrototypeOf(scope), name);
  }
  if (option.e) {
    localScope[constantPool[bytecode[index &#43; 1]]] = option.e;
  }
  while (index &lt; bytecode.length) {
    let t0, t1, t2, t3, t4, t5;
    let instruction = bytecode[index&#43;&#43;];
    if (instruction == 16) {
      return;
    }
    if (instruction == 21) {
      stack.push(`${stack.pop()}`);
    }
    if (instruction == 58) {
      t0 = stack.pop();
      t1 = !t0;
      t5 = bytecode[index&#43;&#43;];
      if (t5) stack.push(t1);
    }
    if (instruction == undefined) {
      throw new Error(&#34;å½“å‰æŒ‡ä»¤ä¸å­˜åœ¨ï¼Œè¯·æ£€æŸ¥æŒ‡ä»¤é›†!&#34;);
    }
    if (instruction == 24) {
      debugger;
    }
    if (instruction == 9) {
      t0 = stack.pop();
      t1 = bytecode[index&#43;&#43;];
      t2 = bytecode[index&#43;&#43;];
      t3 = stack[stack.length - 1];
      t4 = function () {
        return interpreter(localScope, t1, stack, constantPool, bytecode, {
          t: this,
          n: t0,
          f: t0 || t3,
          r: 1
        }, arguments);
      };
      if (t2) {
        stack.push(t4);
      } else {
        localScope[t0] = t4;
      }
    }
    if (instruction == 30) {
      t0 = bytecode[index&#43;&#43;];
      t1 = [];
      for (t2 = 0; t2 &lt; t0; t2&#43;&#43;) {
        t3 = stack.pop();
        t1.unshift(t3);
      }
      t5 = bytecode[index&#43;&#43;];
      if (t5) stack.push(t1);
    }
    if (instruction == 23) {
      t0 = stack.pop();
      t1 = stack.pop();
      t3 = new RegExp(t1, t0);
      stack.push(t3);
    }
    if (instruction == 15) {
      t0 = bytecode[index&#43;&#43;];
      t1 = interpreter(localScope, index, stack, constantPool, bytecode, {
        t: localScope[constantPool[0]]
      });
      if (!t1) {
        index = t0;
      } else {
        if (t1 === 1) {
          return;
        } else {
          if (option.r) {
            return stack.pop();
          }
          return t1;
        }
      }
    }
    if (instruction == 14) {
      t0 = bytecode[index&#43;&#43;];
      t1 = interpreter(localScope, index, stack, constantPool, bytecode, {
        t: localScope[constantPool[0]]
      });
      if (t1 === undefined) {
        index = t0;
      } else {
        if (option.r) {
          return stack.pop();
        }
        return t1;
      }
    }
    if (33 &lt; instruction && instruction &lt; 57) {
      t0 = stack.pop();
      t1 = stack.pop();
      if (instruction == 40) {
        t2 = t1 || t0;
      }
      if (instruction == 43) {
        t2 = t1 &gt;= t0;
      }
      if (instruction == 53) {
        t2 = t1 * t0;
      }
      if (instruction == 36) {
        t2 = t1 &gt;&gt;&gt; t0;
      }
      if (instruction == 46) {
        t2 = t1 != t0;
      }
      if (instruction == 44) {
        t2 = t1 &lt;= t0;
      }
      if (instruction == 48) {
        t2 = t1 !== t0;
      }
      if (instruction == 55) {
        t2 = t1 % t0;
      }
      if (instruction == 35) {
        t2 = t1 in t0;
      }
      if (instruction == 39) {
        t2 = t1 | t0;
      }
      if (instruction == 42) {
        t2 = t1 && t0;
      }
      if (instruction == 51) {
        t2 = t1 &#43; t0;
      }
      if (instruction == 38) {
        t2 = t1 &lt;&lt; t0;
      }
      if (instruction == 52) {
        t2 = t1 - t0;
      }
      if (instruction == 56) {
        t2 = t1 ^ t0;
      }
      if (instruction == 49) {
        t2 = t1 &lt; t0;
      }
      if (instruction == 50) {
        t2 = t1 &gt; t0;
      }
      if (instruction == 34) {
        t2 = t1 instanceof t0;
      }
      if (instruction == 37) {
        t2 = t1 &gt;&gt; t0;
      }
      if (instruction == 54) {
        t2 = t1 / t0;
      }
      if (instruction == 45) {
        t2 = t1 == t0;
      }
      if (instruction == 41) {
        t2 = t1 & t0;
      }
      if (instruction == 47) {
        t2 = t1 === t0;
      }
      t3 = bytecode[index&#43;&#43;];
      if (t3) stack.push(t2);
    }
    if (instruction == 57) {
      t0 = stack.pop();
      t1 = ~t0;
      t5 = bytecode[index&#43;&#43;];
      if (t5) stack.push(t1);
    }
    if (instruction == 20) {
      throw stack.pop();
    }
    if (instruction == 2) {
      t0 = bytecode[index&#43;&#43;];
      t1 = stack.pop();
      t2 = stack.pop();
      args = [];
      for (t3 = 0; t3 &lt; t0; t3&#43;&#43;) args.unshift(stack.pop());
      if (t2 === 0) {
        t4 = t1.apply(localScope, args);
      } else {
        t4 = t2[t1].apply(t2, args);
      }
      t5 = bytecode[index&#43;&#43;];
      if (t5) stack.push(t4);
    }
    if (instruction == 0) {
      t0 = stack.pop();
      t1 = stack.pop();
      t2 = stack.pop();
      t4 = bytecode[index&#43;&#43;];
      t3 = getScope(t1, t0) || t1;
      t3[t0] = t2;
      if (t4) stack.push(t2);
    }
    if (instruction == 29) {
      t0 = stack.pop();
      t1 = stack.pop();
      t2 = stack.pop();
      t2[t1] = t0;
      t5 = bytecode[index&#43;&#43;];
      if (t5) stack.push(t2);
    }
    if (instruction == 32) {
      t0 = stack.pop();
      t1 = void t0;
      t5 = bytecode[index&#43;&#43;];
      if (t5) stack.push(t1);
    }
    if (instruction == 3) {
      t0 = bytecode[index&#43;&#43;];
      t1 = constantPool[t0];
      localScope[t1] = undefined;
    }
    if (instruction == 17) {
      t0 = bytecode[index&#43;&#43;];
      t1 = stack.pop();
      for (t2 = 0; t2 &lt; t0; t2&#43;&#43;) stack.pop();
      t5 = bytecode[index&#43;&#43;];
      if (t5) stack.push(t1);
    }
    if (instruction == 33) {
      t0 = stack.pop();
      t1 = stack.pop();
      t2 = delete t1[t0];
      t5 = bytecode[index&#43;&#43;];
      if (t5) stack.push(t2);
    }
    if (instruction == 8) {
      t0 = stack.pop();
      t1 = stack.pop();
      t2 = bytecode[index&#43;&#43;];
      if (t1 == -1) t1 = t2;
      t1 = t0[t1];
      index = t1;
    }
    if (instruction == 18) {
      t0 = stack.pop();
      t0 = Number(t0);
      if (t0 == NaN) t0 = -1;
      stack.push(t0);
    }
    if (instruction == 6) {
      t0 = bytecode[index&#43;&#43;];
      index = t0;
    }
    if (instruction == 26) {
      t0 = bytecode[index&#43;&#43;];
      t1 = stack.pop();
      t2 = stack.pop();
      t3 = getScope(t2, t1) || t2;
      t4 = !t0 ? t3[t1]-- : --t3[t1];
      t5 = bytecode[index&#43;&#43;];
      if (t5) stack.push(t4);
    }
    if (instruction == 22) {
      t0 = bytecode[index&#43;&#43;];
      t2 = &#34;&#34;;
      for (t1 = 0; t1 &lt; t0; t1&#43;&#43;) {
        t2 &#43;= stack.pop();
      }
      t5 = bytecode[index&#43;&#43;];
      if (t5) stack.push(t2);
    }
    if (instruction == 13) {
      stack.push(window);
    }
    if (instruction == 27) {
      t0 = stack.pop();
      t1 = typeof t0;
      t5 = bytecode[index&#43;&#43;];
      if (t5) stack.push(t1);
    }
    if (instruction == 12) {
      stack.push(localScope);
    }
    if (instruction == 4) {
      t0 = bytecode[index&#43;&#43;];
      stack.push(constantPool[t0]);
    }
    if (instruction == 25) {
      t0 = bytecode[index&#43;&#43;];
      t1 = stack.pop();
      t2 = stack.pop();
      t3 = getScope(t2, t1) || t2;
      t4 = !t0 ? t3[t1]&#43;&#43; : &#43;&#43;t3[t1];
      t5 = bytecode[index&#43;&#43;];
      if (t5) stack.push(t4);
    }
    if (instruction == 28) {
      stack.push({});
    }
    if (instruction == 19) {
      t2 = bytecode[index&#43;&#43;];
      t3 = bytecode[index&#43;&#43;];
      t4 = bytecode[index&#43;&#43;];
      t5 = bytecode[index&#43;&#43;];
      try {
        t1 = interpreter(localScope, t3, stack, constantPool, bytecode, {
          t: localScope[constantPool[0]]
        });
        if (t1 &gt; 0) {
          if (option.r) {
            return stack.pop();
          }
          return t1;
        }
      } catch (e) {
        t1 = interpreter(localScope, t4, stack, constantPool, bytecode, {
          t: localScope[constantPool[0]],
          e: e
        });
        if (t1 &gt; 0) {
          if (option.r) {
            return stack.pop();
          }
          return t1;
        }
      } finally {
        t1 = interpreter(localScope, t5, stack, constantPool, bytecode, {
          t: localScope[constantPool[0]]
        });
        if (t1 &gt; 0) {
          if (option.r) {
            return stack.pop();
          }
          return t1;
        }
      }
      index = t2;
    }
    if (instruction == 5) {
      t0 = constantPool[bytecode[index&#43;&#43;]];
      t1 = localScope;
      t2 = t1[t0];
      t5 = bytecode[index&#43;&#43;];
      if (t5) stack.push(t2);
    }
    if (instruction == 31) {
      t0 = stack.pop();
      t1 = stack.pop();
      t2 = bytecode[index&#43;&#43;];
      args = [];
      for (t3 = 0; t3 &lt; t2; t3&#43;&#43;) args.unshift(stack.pop());
      t4 = new t1[t0](...args);
      t5 = bytecode[index&#43;&#43;];
      if (t5) stack.push(t4);
    }
    if (instruction == 1) {
      t0 = stack.pop();
      t1 = stack.pop();
      t5 = bytecode[index&#43;&#43;];
      if (t5) stack.push(t1[t0]);
    }
    if (instruction == 7) {
      t0 = stack.pop();
      t1 = bytecode[index&#43;&#43;];
      if (!t0) index = t1;
    }
    if (instruction == 11) {
      if (option.r) {
        return stack.pop();
      }
      return bytecode[index&#43;&#43;];
    }
    if (instruction == 10) {
      t0 = bytecode[index&#43;&#43;];
      if (!args) args = [].concat(stack);
      for (t1 = t0; t1 &gt;= 0; t1--) {
        t2 = stack.pop();
        localScope[t2] = args[t1];
      }
    }
  }
})(typeof window !== &#39;undefined&#39; ? window : (window = global, window), 0, [],[&#34;@faceless&#34;,&#34;arguments&#34;,&#34;__proto__&#34;,&#34;a&#34;,&#34;b&#34;,22,2,6,4,&#34;c&#34;,70,7,&#34;test&#34;,100,&#34;console&#34;,&#34;log&#34;], [3,3,3,4,4,5,12,4,3,0,1,17,0,0,5,3,1,4,6,54,1,12,4,4,0,1,17,0,0,5,4,1,4,7,53,1,5,3,1,4,8,52,1,51,1,13,4,9,0,0,5,9,1,4,10,50,1,7,76,14,74,5,9,1,4,11,54,1,13,4,9,0,0,16,6,76,4,12,4,13,51,1,5,9,1,51,1,12,4,14,1,1,4,15,2,1,0])
````
</textarea></div>


                <script>
                   $(function () {
                        
                        editormd.markdownToHTML("content");
                    })

                </script>




                </div>

                <hr>


                <div>
                    <h5>Â© ç‰ˆæƒå£°æ˜ï¼šéæ ‡æ³¨ã€è½¬è½½ã€æƒ…å†µä¸‹æœ¬æ–‡ä¸ºåŸåˆ›æ–‡ç« ï¼Œç‰ˆæƒå½’&nbsp;<a href="/">Depy's docs</a>&nbsp;æ‰€æœ‰ï¼Œè½¬è½½è¯·è”ç³»åšä¸»è·å¾—æˆæƒã€‚</h5>
                </div>

            </article>



    <div class="ad d-none d-lg-block">

        <div style="margin-left: 20px;margin-bottom:15px;font-weight:bold"> ã€ç›®å½•ã€ </div>
    <div class="anchorContent" id="anchorContent"> </div>
                       </div>

            </div>
    </section>
    <button class="sidebar-toggle sidebar-toggle-button" aria-label="Menu">
        <div><span></span><span></span><span></span></div>
    </button>

</main>

<link href="https://file.depy.ink/theme/docs/css/prettify.css?v=5530" rel="stylesheet">
<script src="https://file.depy.ink/theme/docs/js/prettify.js?v=5764"></script>
<script src="https://file.depy.ink/theme/docs/js/view.js?v=4125"></script>



<script>


    
    function addWatermark({
        container = document.body, 
        width = "220px", 
        height = "160px", 
        textAlign = "center", 
        textBaseline = "middle", 
        font = "16px Microsoft Yahei", 
        fillStyle = "rgba(184, 184, 184, 0.6)", 
        content = "depy|rce.ink", 
        rotate = "45", 
        zIndex = 10000, 
    }) {
        
        const canvas = document.createElement("canvas");
        canvas.setAttribute("width", width);
        canvas.setAttribute("height", height);
        const ctx = canvas.getContext("2d");
        ctx.textAlign = textAlign;
        ctx.textBaseline = textBaseline;
        ctx.font = font;
        ctx.fillStyle = fillStyle;
        ctx.rotate((Math.PI / 180) * rotate);
        ctx.fillText(content, parseFloat(width) / 2, parseFloat(height) / 2);

        
        const base64Url = canvas.toDataURL();
        const __wm = document.querySelector('.__wm');
        const watermarkDiv = __wm || document.createElement("div");
        const styleStr = `
                    position: fixed;
                    top: -70px;
                    left: 0;
                    bottom: 0;
                    right: 0;
                    width: 100%;
                    height: 100%;
                    z-index: ${zIndex};
                    pointer-events: none;
                    background-repeat: repeat;
                    background-image: url('${base64Url}')
                `;
        watermarkDiv.setAttribute("style", styleStr);
        watermarkDiv.classList.add("__wm");
        

        if (!__wm) {
            container.style.position = 'relative';
            container.insertBefore(watermarkDiv, container.firstChild);
        }
            
            const MutationObserver = window.MutationObserver || window.WebKitMutationObserver;
            if (MutationObserver) {
                let mo = new MutationObserver(function () {
                    const __wm = document.querySelector('.__wm');
                    
                    if ((__wm && __wm.getAttribute('style') !== styleStr) || !__wm) {
                        
                        mo.disconnect();
                        mo = null;
                        console.log('1');
                        addWatermark({
                            container: document.getElementById("watermark"),
                            width: "220px",
                            height: "160px",
                            textAlign: "center",
                            textBaseline: "middle",
                            font: "16px Microsoft Yahei",
                            fillStyle: "rgba(184, 184, 184, 0.3 )",
                            content: "depy|rce.ink",
                            rotate: "30",
                            zIndex: 10000,
                        });
                    }
                });

                mo.observe(container, {
                    attributes: true,
                    subtree: true,
                    childList: true
                });
            }
    }



    function addwm(){
    addWatermark({
        container: document.getElementById("watermark"),
        width: "220px",
        height: "160px",
        textAlign: "center",
        textBaseline: "middle",
        font: "16px Microsoft Yahei",
        fillStyle: "rgba(184, 184, 184, 0.3 )",
        content: "depy|rce.ink",
        rotate: "30",
        zIndex: 10000,
    });
}

addwm();
</script>

</body>
</html>