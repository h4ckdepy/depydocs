<!doctype html>
<html lang="zh-cn" >
<head>
    <meta charset="utf-8">
    <link rel="icon" href="data:image/ico;base64,aWNv">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link href="https://file.depy.ink/theme/docs/css/bootstrap.min.css?v=8280" rel="stylesheet">
    <link href="https://file.depy.ink/theme/docs/css/main.css?v=3525" rel="stylesheet">
    <script src="https://file.depy.ink/theme/docs/js/jquery.min.js"></script>
    <script src="https://file.depy.ink/theme/docs/js/bootstrap.min.js?v=4094"></script>
    <script src="https://file.depy.ink/theme/docs/js/functions.js?v=8141"></script>
    <script src="https://file.depy.ink/theme/docs/js/marked.min.js"></script>
    <link href="https://file.depy.ink/theme/docs/css/doc.css?v=4299" rel="stylesheet">
    <link rel="stylesheet" href="https://file.depy.ink/assets/editor/editormd/css/editormd.css?v=6567" />
    <script src="https://file.depy.ink/assets/editor/editormd/editormd.js"></script>
    <script src="https://file.depy.ink/assets/editor/editormd/lib/marked.min.js"></script>
    <script src="https://file.depy.ink/assets/editor/editormd/lib/prettify.min.js"></script>

    <script src="https://file.depy.ink/theme/docs/js/pjax.min.js"></script>
    


    <script src="https://file.depy.ink/theme/docs/js/lightbox-plus-jquery.min.js"> </script>
    <link href="https://file.depy.ink/theme/docs/css/lightbox.css?v=3328" rel="stylesheet"><title>ğŸ“‘ã€NDKå¼€å‘ã€‘åŸºç¡€ç¯å¢ƒæ­å»º</title>
</head>

<body class="bg-light ready sticky" id="watermark">


             <nav class="navbar navbar-expand-lg navbar-light shadow-sm bg-white mybt2 sticky-top">
        <div class="container-fluid" style="max-width:1332px;">
            <a class="navbar-brand" href="/"><b class="">Depy's docs</b></a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
                        <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav mr-auto">
                    <li class="nav-item active">
                        <a class="nav-link" href="/" >é¦–é¡µ</a>
                    </li>

                </ul>

            </div>
        </div>
    </nav>


<main>


<aside class="sidebar">
           <div class="sidebar-nav mt-2">
            <ul>
            <li>

 <p>Todo</p>
    <ul>
<li><a href="/view/118.html">Todo List</a></li>
    </ul>
 <p>éšç¬”</p>
    <ul>
<li><a href="/view/128.html">å°å¹´</a></li>
<li><a href="/view/109.html">â¤ 2023</a></li>
    </ul>
 <p>æµ‹è¯•ç¬”è®°</p>
    <ul>
<li><a href="/view/129.html">ğŸ˜¡ å…³äºDDOSæˆ‘èƒ½åšä»€ä¹ˆ</a></li>
<li><a href="/view/123.html">ğŸ‘ æŸåŠ å¯†æ ·æœ¬ Traceåˆ†æ - 2</a></li>
<li><a href="/view/121.html">ğŸ‘ æŸåŠ å¯†æ ·æœ¬ Traceåˆ†æ</a></li>
<li><a href="/view/115.html">ğŸ”§ è½»é‡çº§CI/CD+æ–‡ä»¶å†…å®¹ç›‘æ§/é˜²ç¯¡æ”¹è§£å†³æ–¹æ¡ˆ</a></li>
<li><a href="/view/105.html">ğŸ¯ æœ‰ç”¨çš„å‘½ä»¤å¤‡ä»½</a></li>
<li><a href="/view/94.html">ğŸ˜Š Gateway-wokerå®ç°çƒ­é‡è½½</a></li>
<li><a href="/view/90.html">âœï¸ Xposedè¿è¡ŒåŸç†</a></li>
<li><a href="/view/89.html">AutoJS æ¨¡æ‹Ÿè´å¡å°”æ›²çº¿è§†é¢‘æ»‘åŠ¨</a></li>
<li><a href="/view/84.html">ğŸ“± å°ç±³13ç»•è¿‡SIMå¡æ‰“å¼€USBå®‰è£…</a></li>
    </ul>
 <p>è¯»ä¹¦ç¬”è®°</p>
    <ul>
<li><a href="/view/119.html">ğŸ“š æ³¨å…¥ä¸HOOK</a></li>
<li><a href="/view/117.html">ğŸ“šã€Šæ·±å…¥æ¢ç´¢å®‰å“çƒ­ä¿®å¤æŠ€æœ¯åŸç†ã€‹32 -</a></li>
<li><a href="/view/112.html">ğŸ“šã€Šæ·±å…¥æ¢ç´¢å®‰å“çƒ­ä¿®å¤æŠ€æœ¯åŸç†ã€‹1-32</a></li>
<li><a href="/view/82.html">ğŸ“šã€Šé€†å‘å·¥ç¨‹æƒå¨æŒ‡å—ã€‹ - 1-4ç« </a></li>
    </ul>
 <p>ç¼–ç¨‹å¼€å‘</p>
    <ul>
<li><a href="/view/111.html">ğŸŒ¹ Dobbyä½¿ç”¨</a></li>
<li><a href="/view/77.html">ğŸ“‘ã€å‰ç«¯å¼€å‘ã€‘lightbox+pjaxæœ€ä½³å®è·µ</a></li>
<li><a href="/view/71.html">ğŸ“‘ã€NDKå¼€å‘ã€‘NDKé‡‡é›†ã€å‹ç¼©ã€åŠ å¯†ä¼ è¾“è®¾å¤‡ä¿¡æ¯</a></li>
<li><a href="/view/70.html">ğŸ“‘ã€NDKå¼€å‘ã€‘åŸºç¡€ç¯å¢ƒæ­å»º</a></li>
    </ul>
 <p>é€†å‘åˆ†æ</p>
    <ul>
<li><a href="/view/86.html">âš™ï¸ ã€Xposed æ”¹æœºã€‘- åŸºç¡€ç¯å¢ƒå®‰è£…</a></li>
<li><a href="/view/81.html">ğŸ’» å®‰å“å†…è”æ±‡ç¼–å¼€å‘</a></li>
<li><a href="/view/76.html">ğŸ“‘ JNI ä½¿ç”¨åŸºç¡€</a></li>
<li><a href="/view/75.html">ğŸ“‘ IDA Debugger è°ƒè¯•å™¨ä½¿ç”¨</a></li>
<li><a href="/view/74.html">ğŸ’» std::stringå†…å­˜å¸ƒå±€</a></li>
<li><a href="/view/73.html">ğŸ’¼ Fridaä½œä¸š-20231114</a></li>
<li><a href="/view/65.html">ğŸ§® JSVMPæ‰§è¡Œæµç¨‹åˆ†æ</a></li>
    </ul>
 <p>DepyDocs</p>
    <ul>
<li><a href="/view/122.html">ğŸ“‘ DepyDocs</a></li>
<li><a href="/view/120.html">ğŸ“‘  Un1kMsgä½¿ç”¨</a></li>
<li><a href="/view/114.html">ğŸ“‘ è”ç³»æ–¹å¼</a></li>
<li><a href="/view/91.html">ğŸ“‘ é¢å¤–é…ç½®</a></li>
<li><a href="/view/88.html">ğŸ“‘  æ›´æ–°æ—¥å¿—</a></li>
<li><a href="/view/72.html">ğŸ“‘ æ—¶å…‰æœºä½¿ç”¨</a></li>
<li><a href="/view/66.html">ğŸ“‘ DepyOauthæ¥å…¥æŒ‡å—</a></li>
<li><a href="/view/62.html">ğŸ“‘ å®˜æ–¹åŸŸåç”³è¯·</a></li>
<li><a href="/view/47.html">ğŸ“‘ ç§Ÿæˆ·è‡ªå®šä¹‰åŸŸåç»‘å®š</a></li>
    </ul>
 <p>åšå®¢æ–‡ç« ï¼ˆå¤‡ä»½ï¼‰</p>
    <ul>
<li><a href="/view/133.html"></a></li>
<li><a href="/view/132.html">Un1kLog4shellScan </a></li>
<li><a href="/view/131.html">Netty å¼€å‘Mitmè§£å†³è¯·æ±‚å“åº”åŒ¹é…é—®é¢˜	</a></li>
    </ul>


</li>
</ul></div>
</aside><section class="content mx-auto" id="article">
        <div class="d-flex">



            <article class="markdown-section" id="main" style="word-break:break-all;">
                <div>
                <h1>ğŸ“‘ã€NDKå¼€å‘ã€‘åŸºç¡€ç¯å¢ƒæ­å»º</h1>


                <a style="font-size:12px;color: #5f5d5d;">
                | æ—¶é—´: 2023-11-08 15:53:56| ç›®å½•:ç¼–ç¨‹å¼€å‘ </a>
                |
                <a style="font-size:12px;color: #007bff;" href="http://10.8.0.3:5080/tenantadmin/Tenantarticle/quickedit/quickedit.html?id=118" target="_blank">ç¼–è¾‘æœ¬æ–‡</a>
                <br>


                    <div id="content"><textarea style="display: none;">## ç¯å¢ƒå®‰è£…

å®˜ç½‘Android Studioä¸€æŠŠæ¢­ï¼ŒåŠ¡å¿…ä½¿ç”¨éä¸­å›½å¤§é™†ä»£ç†åä¸‹è½½dl.google.comä¸Šçš„ä¸€äº›ä¾èµ–ï¼Œä¸ç„¶ä½ ä¼šç—›è‹¦ã€‚

## å‰ç½®çŸ¥è¯†

æ­¤å‰ç ”ç©¶è¿‡webviewå’Œjavaå±‚è¿›è¡Œé€šä¿¡çš„æ–¹å¼ï¼Œåœ¨ç¾å›¢è¿™ä¸ªå«åšknbã€‚ä¸ä¹‹ç±»ä¼¼æ›´åº•å±‚çš„å°±æ˜¯JNIï¼ŒNDKå·¥å…·ä½¿å’±ä»¬èƒ½å¤Ÿåœ¨ Android åº”ç”¨ä¸­ä½¿ç”¨ C å’Œ C&#43;&#43; ä»£ç ï¼Œå®ƒæä¾›äº†ä¼—å¤šå¹³å°åº“ï¼Œæˆ‘ä»¬å¯ä½¿ç”¨è¿™äº›å¹³å°åº“ç®¡ç†åŸç”Ÿ activity å’Œè®¿é—®å®ä½“è®¾å¤‡ç»„ä»¶ï¼Œä¾‹å¦‚ä¼ æ„Ÿå™¨å’Œè§¦æ§è¾“å…¥ã€‚

ä¸ºäº†åº”ç”¨çš„å®‰å…¨æ€§ï¼Œä¼šå°†ä¸€äº›å¤æ‚çš„é€»è¾‘å’Œç®—æ³•é€šè¿‡æœ¬åœ°ä»£ç ï¼ˆCæˆ–C&#43;&#43;ï¼‰æ¥å®ç°ï¼Œç„¶åæ‰“åŒ…æˆ.soåŠ¨æ€åº“æ–‡ä»¶ï¼Œå¹¶æä¾› Java æ¥å£ä¾›åº”ç”¨å±‚è°ƒç”¨ï¼Œè¿™ä¹ˆåšçš„ç›®çš„ä¸»è¦å°±æ˜¯ä¸ºäº†æä¾›åº”ç”¨çš„å®‰å…¨æ€§ï¼Œé˜²æ­¢è¢«åç¼–è¯‘åè¢«ä¸æ³•åˆ†å­åˆ†æåº”ç”¨çš„é€»è¾‘ã€‚


## åŸºç¡€æ–‡ä»¶ç›®å½•

### Cmake.list

![](https://p0.meituan.net/xianfu/4776ecd2dda9446aa1f21fbc397efca465724.png%40watermark=1&&object=L3dkY2Zsb3cvN2RiN2M4NTFjYmVjZDg4MTM1OTZjMTYzOWE2MzQ4MDM0MjY0LnBuZw==&p=8&t=90&x=10&y=10)

ç¬¬ä¸€è¡ŒæŒ‡å®šæ‰€éœ€çš„ CMake æœ€ä½ç‰ˆæœ¬ã€‚
ç¬¬äºŒè¡Œè®¾ç½®é¡¹ç›®åç§°ä¸º &#34;a****&#34;ã€‚
ç¬¬ä¸‰è¡Œæ·»åŠ ä¸€ä¸ªåä¸º ${CMAKE_PROJECT_NAME} çš„å…±äº«åº“ï¼Œå¹¶å°†æºæ–‡ä»¶ native-lib.cpp å’Œ native_depy.cpp æ·»åŠ åˆ°è¯¥åº“ä¸­ã€‚è¿™äº›æºæ–‡ä»¶å°†è¢«ç¼–è¯‘ä¸ºå…±äº«åº“ã€‚
ç¬¬å››è¡ŒæŒ‡å®šé“¾æ¥åˆ° ${CMAKE_PROJECT_NAME} åº“çš„å…¶ä»–åº“ã€‚åœ¨è¿™é‡Œï¼Œ${CMAKE_PROJECT_NAME} åº“å°†é“¾æ¥åˆ° Android NDK æä¾›çš„ android åº“å’Œ log åº“ã€‚è¿™æ ·ç¼–è¯‘ç”Ÿæˆçš„libaaä¼šå¼•ç”¨åŒ…å«androidå’Œlogä¸¤ä¸ªåº“ã€‚

### com/example/a2023110803/MainActivity.java

```java
package com.example.a2023110803;
import androidx.appcompat.app.AppCompatActivity;
import android.os.Bundle;
import android.widget.TextView;
import com.example.a2023110803.databinding.ActivityMainBinding;


public class MainActivity extends AppCompatActivity {

    static {
        System.loadLibrary(&#34;aa&#34;);
    }

    private ActivityMainBinding binding;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        binding = ActivityMainBinding.inflate(getLayoutInflater());
        setContentView(binding.getRoot());

        TextView tv = binding.sampleText;
        tv.setText(xxjni());
    }

    public native String xxjni();

    public native String testJNI();
}
```

ä»£ç ä¸­å®šä¹‰ä¸¤ä¸ªnativeå‡½æ•°ï¼Œxxjni()å’Œtestjni()ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡jniè°ƒç”¨è¿™ä¸¤ä¸ªæ–¹æ³•ã€‚
åœ¨onCreateçš„æœ€åä¸¤è¡Œï¼Œæˆ‘ä»¬è°ƒç”¨äº†xxjni()æ–¹æ³•ï¼Œå¹¶é€šè¿‡TextViewçš„setTextæ–¹æ³•æŠŠè¿”å›å€¼è®¾ç½®åœ¨å±å¹•ä¸Šã€‚

### native_depy.cpp

åœ¨cmake.listä¸­æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå…±äº«åº“ï¼Œä¼šæŠŠnative_depy.cppå’Œå¦ä¸€ä¸ªcppæ–‡ä»¶æ·»åŠ åˆ°åº“ä¸­ã€‚javaä»£ç æœ€ç»ˆè°ƒç”¨æ—¶ï¼Œä¹Ÿæ˜¯è°ƒç”¨cppé‡Œå®šä¹‰çš„å‡½æ•°ã€‚

ä»£ç å¦‚ä¸‹ï¼š

```cpp
#include &lt;jni.h&gt;
#include &lt;string&gt;

extern &#34;C&#34; jstring
Java_com_example_a2023110803_MainActivity_xxjni(JNIEnv *env,jobject) {
    std::string hello = &#34;a222nother&#34;;
    return env-&gt;NewStringUTF(hello.c_str());
}
```

åœ¨è¿™ä¸ªå£°æ˜å‡½æ•°çš„ä»£ç ä¸­ï¼Œä½¿ç”¨äº† extern &#34;C&#34; å…³é”®å­—ã€‚è¿™æ˜¯å› ä¸º C&#43;&#43; æ”¯æŒå‡½æ•°é‡è½½ï¼Œè€Œ Java ä¸æ”¯æŒå‡½æ•°é‡è½½ã€‚ä¸ºäº†èƒ½å¤Ÿåœ¨ C&#43;&#43; ä¸­å®šä¹‰ä¸€ä¸ªå¯ä»¥è¢« Java è°ƒç”¨çš„å‡½æ•°ï¼Œéœ€è¦ä½¿ç”¨ extern &#34;C&#34; æ¥å‘Šè¯‰ç¼–è¯‘å™¨æŒ‰ç…§ C è¯­è¨€çš„è§„åˆ™è¿›è¡Œå‡½æ•°å‘½åå’Œè°ƒç”¨çº¦å®šã€‚

é€šè¿‡jstringè¿™ä¸ªJNI ä¸­çš„æ•°æ®ç±»å‹ï¼Œè¡¨ç¤ºä¸€ä¸ª Java å­—ç¬¦ä¸²ã€‚

å‡½æ•°å£°æ˜åšäº†é™æ€ç»‘å®šï¼Œéœ€è¦java&#43;åŒ…å&#43;å‡½æ•°åçš„æ–¹å¼ï¼ŒåŒæ—¶é»˜è®¤å¸¦æœ‰ä¸¤ä¸ªå‚æ•°ã€‚JNIEnv æ˜¯ä¸€ä¸ªæŒ‡å‘ JNI ç¯å¢ƒçš„æŒ‡é’ˆï¼Œjobject æ˜¯ä¸€ä¸ªä»£è¡¨è°ƒç”¨è¯¥å‡½æ•°çš„ Java å¯¹è±¡çš„æŒ‡é’ˆã€‚æ–¹ä¾¿c&#43;&#43;ä»javaå±‚è°ƒç”¨æ–¹æ³•æˆ–è€…è·å–æ•°æ®ã€‚

std::string hello = &#34;a222nother&#34;;: åœ¨ C&#43;&#43; ä¸­åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²å˜é‡ helloï¼Œå¹¶èµ‹å€¼ä¸º &#34;a222nother&#34;ã€‚
return env-&gt;NewStringUTF(hello.c_str());: ä½¿ç”¨ JNI ç¯å¢ƒçš„ NewStringUTF å‡½æ•°å°† C&#43;&#43; å­—ç¬¦ä¸²è½¬æ¢ä¸º Java å­—ç¬¦ä¸²ï¼Œå¹¶è¿”å›ç»™ Java ç«¯ã€‚

## ç¼–è¯‘æµ‹è¯•

![](https://p0.meituan.net/xianfu/6a2529dfbdd601580b3ed35b34997c2269860.png%40watermark=1&&object=L3dkY2Zsb3cvN2RiN2M4NTFjYmVjZDg4MTM1OTZjMTYzOWE2MzQ4MDM0MjY0LnBuZw==&p=8&t=90&x=10&y=10)

è®¾ç½®è¿‡æ»¤ï¼Œåªç¼–è¯‘arm64ã€‚ï¼ˆåˆ é™¤ä¼šç¼–è¯‘å¤šä¸ªå¹³å°libsoï¼Œä½†æ˜¯ç›®å‰å¤Ÿç”¨ï¼‰
ç‚¹å‡»build-&gt;rebuild project ï¼Œåœ¨outputs -&gt;debugç›®å½•ä¸‹å¾—åˆ°ä¸€ä¸ªapkã€‚

![](https://p0.meituan.net/xianfu/97dc161e82cff23a5690622ebfe8b121114047.png%40watermark=1&&object=L3dkY2Zsb3cvN2RiN2M4NTFjYmVjZDg4MTM1OTZjMTYzOWE2MzQ4MDM0MjY0LnBuZw==&p=8&t=90&x=10&y=10)

è§£å‹åå°±èƒ½çœ‹åˆ°ç¼–è¯‘å¥½çš„soæ–‡ä»¶äº†ã€‚</textarea></div>


                <script>
                   $(function () {
                        
                        editormd.markdownToHTML("content");
                    })

                </script>




                </div>

                <hr>


                <div>
                    <h5>Â© ç‰ˆæƒå£°æ˜ï¼šéæ ‡æ³¨ã€è½¬è½½ã€æƒ…å†µä¸‹æœ¬æ–‡ä¸ºåŸåˆ›æ–‡ç« ï¼Œç‰ˆæƒå½’&nbsp;<a href="/">Depy's docs</a>&nbsp;æ‰€æœ‰ï¼Œè½¬è½½è¯·è”ç³»åšä¸»è·å¾—æˆæƒã€‚</h5>
                </div>

            </article>



    <div class="ad d-none d-lg-block">

        <div style="margin-left: 20px;margin-bottom:15px;font-weight:bold"> ã€ç›®å½•ã€ </div>
    <div class="anchorContent" id="anchorContent"> </div>
                       </div>

            </div>
    </section>
    <button class="sidebar-toggle sidebar-toggle-button" aria-label="Menu">
        <div><span></span><span></span><span></span></div>
    </button>

</main>

<link href="https://file.depy.ink/theme/docs/css/prettify.css?v=5530" rel="stylesheet">
<script src="https://file.depy.ink/theme/docs/js/prettify.js?v=5764"></script>
<script src="https://file.depy.ink/theme/docs/js/view.js?v=4125"></script>



<script>


    
    function addWatermark({
        container = document.body, 
        width = "220px", 
        height = "160px", 
        textAlign = "center", 
        textBaseline = "middle", 
        font = "16px Microsoft Yahei", 
        fillStyle = "rgba(184, 184, 184, 0.6)", 
        content = "depy|rce.ink", 
        rotate = "45", 
        zIndex = 10000, 
    }) {
        
        const canvas = document.createElement("canvas");
        canvas.setAttribute("width", width);
        canvas.setAttribute("height", height);
        const ctx = canvas.getContext("2d");
        ctx.textAlign = textAlign;
        ctx.textBaseline = textBaseline;
        ctx.font = font;
        ctx.fillStyle = fillStyle;
        ctx.rotate((Math.PI / 180) * rotate);
        ctx.fillText(content, parseFloat(width) / 2, parseFloat(height) / 2);

        
        const base64Url = canvas.toDataURL();
        const __wm = document.querySelector('.__wm');
        const watermarkDiv = __wm || document.createElement("div");
        const styleStr = `
                    position: fixed;
                    top: -70px;
                    left: 0;
                    bottom: 0;
                    right: 0;
                    width: 100%;
                    height: 100%;
                    z-index: ${zIndex};
                    pointer-events: none;
                    background-repeat: repeat;
                    background-image: url('${base64Url}')
                `;
        watermarkDiv.setAttribute("style", styleStr);
        watermarkDiv.classList.add("__wm");
        

        if (!__wm) {
            container.style.position = 'relative';
            container.insertBefore(watermarkDiv, container.firstChild);
        }
            
            const MutationObserver = window.MutationObserver || window.WebKitMutationObserver;
            if (MutationObserver) {
                let mo = new MutationObserver(function () {
                    const __wm = document.querySelector('.__wm');
                    
                    if ((__wm && __wm.getAttribute('style') !== styleStr) || !__wm) {
                        
                        mo.disconnect();
                        mo = null;
                        console.log('1');
                        addWatermark({
                            container: document.getElementById("watermark"),
                            width: "220px",
                            height: "160px",
                            textAlign: "center",
                            textBaseline: "middle",
                            font: "16px Microsoft Yahei",
                            fillStyle: "rgba(184, 184, 184, 0.3 )",
                            content: "depy|rce.ink",
                            rotate: "30",
                            zIndex: 10000,
                        });
                    }
                });

                mo.observe(container, {
                    attributes: true,
                    subtree: true,
                    childList: true
                });
            }
    }



    function addwm(){
    addWatermark({
        container: document.getElementById("watermark"),
        width: "220px",
        height: "160px",
        textAlign: "center",
        textBaseline: "middle",
        font: "16px Microsoft Yahei",
        fillStyle: "rgba(184, 184, 184, 0.3 )",
        content: "depy|rce.ink",
        rotate: "30",
        zIndex: 10000,
    });
}

addwm();
</script>

</body>
</html>