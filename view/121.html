

<!doctype html>
<html lang="zh-cn" >
<head>
    <meta charset="utf-8">
    <link rel="icon" href="data:image/ico;base64,aWNv">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link href="https://rce.ink/theme/docs/css/bootstrap.min.css?v=8280" rel="stylesheet">
    <link href="https://rce.ink/theme/docs/css/main.css?v=3525" rel="stylesheet">
    <script src="https://rce.ink/theme/docs/js/jquery.min.js"></script>
    <script src="https://rce.ink/theme/docs/js/bootstrap.min.js?v=4094"></script>
    <script src="https://rce.ink/theme/docs/js/functions.js?v=8141"></script>
    <script src="https://rce.ink/theme/docs/js/marked.min.js"></script>
    <link href="https://rce.ink/theme/docs/css/doc.css?v=4299" rel="stylesheet">
    <link rel="stylesheet" href="https://rce.ink/assets/editor/editormd/css/editormd.css?v=6567" />
    <script src="https://rce.ink/assets/editor/editormd/editormd.js"></script>
    <script src="https://rce.ink/assets/editor/editormd/lib/marked.min.js"></script>
    <script src="https://rce.ink/assets/editor/editormd/lib/prettify.min.js"></script>

    <script src="https://rce.ink/theme/docs/js/pjax.min.js"></script>
    <!--<script type="text/javascript" src="/assets/jquery.pjax.min.js"></script>-->
    
    
    <script src="https://rce.ink/theme/docs/js/lightbox-plus-jquery.min.js"> </script>
    <link href="https://rce.ink/theme/docs/css/lightbox.css?v=3328" rel="stylesheet"><title>ğŸ‘ æŸåŠ å¯†æ ·æœ¬ Traceåˆ†æ - Depy's docs</title><li><a href="/view/121.html">ğŸ‘ æŸåŠ å¯†æ ·æœ¬ Traceåˆ†æ</a></li>
</head>

<body class="bg-light ready sticky" id="watermark">


             <nav class="navbar navbar-expand-lg navbar-light shadow-sm bg-white mybt2 sticky-top">
        <div class="container-fluid" style="max-width:1332px;">
            <a class="navbar-brand" href="/"><b class="">Depy's docs</b></a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
                        <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav mr-auto">
                    <li class="nav-item active">
                        <a class="nav-link" href="/" >é¦–é¡µ</a>
                    </li>

                </ul>

            </div>
        </div>
    </nav>
                     

<main>


<aside class="sidebar">
           <div class="sidebar-nav mt-2">
            <ul>

                

                


<li> <p>DepyDocs</p>
    <ul>
<li><a href="/view/122.html">ğŸ“‘ DepyDocs</a></li>
<li><a href="/view/120.html">ğŸ“‘  Un1kMsgä½¿ç”¨</a></li>
<li><a href="/view/114.html">ğŸ“‘ è”ç³»æ–¹å¼</a></li>
<li><a href="/view/91.html">ğŸ“‘ é¢å¤–é…ç½®</a></li>
<li><a href="/view/88.html">ğŸ“‘  æ›´æ–°æ—¥å¿—</a></li>
<li><a href="/view/72.html">ğŸ“‘ æ—¶å…‰æœºä½¿ç”¨</a></li>
<li><a href="/view/66.html">ğŸ“‘ DepyOauthæ¥å…¥æŒ‡å—</a></li>
<li><a href="/view/62.html">ğŸ“‘ å®˜æ–¹åŸŸåç”³è¯·</a></li>
<li><a href="/view/47.html">ğŸ“‘ ç§Ÿæˆ·è‡ªå®šä¹‰åŸŸåç»‘å®š</a></li>
    </ul>
 <p>Todo</p>
    <ul>
<li><a href="/view/118.html">Todo List</a></li>
    </ul>
 <p>éšç¬”</p>
    <ul>
<li><a href="/view/128.html">å°å¹´</a></li>
<li><a href="/view/109.html">â¤ 2023</a></li>
    </ul>
 <p>æµ‹è¯•ç¬”è®°</p>
    <ul>
<li><a href="/view/123.html">ğŸ‘ æŸåŠ å¯†æ ·æœ¬ Traceåˆ†æ - 2</a></li>
<li><a href="/view/121.html">ğŸ‘ æŸåŠ å¯†æ ·æœ¬ Traceåˆ†æ</a></li>
<li><a href="/view/115.html">ğŸ”§ è½»é‡çº§CI/CD+æ–‡ä»¶å†…å®¹ç›‘æ§/é˜²ç¯¡æ”¹è§£å†³æ–¹æ¡ˆ</a></li>
<li><a href="/view/105.html">ğŸ¯ æœ‰ç”¨çš„å‘½ä»¤å¤‡ä»½</a></li>
<li><a href="/view/94.html">ğŸ˜Š Gateway-wokerå®ç°çƒ­é‡è½½</a></li>
<li><a href="/view/90.html">âœï¸ Xposedè¿è¡ŒåŸç†</a></li>
<li><a href="/view/89.html">AutoJS æ¨¡æ‹Ÿè´å¡å°”æ›²çº¿è§†é¢‘æ»‘åŠ¨</a></li>
<li><a href="/view/84.html">ğŸ“± å°ç±³13ç»•è¿‡SIMå¡æ‰“å¼€USBå®‰è£…</a></li>
    </ul>
 <p>è¯»ä¹¦ç¬”è®°</p>
    <ul>
<li><a href="/view/119.html">ğŸ“š æ³¨å…¥ä¸HOOK</a></li>
<li><a href="/view/117.html">ğŸ“šã€Šæ·±å…¥æ¢ç´¢å®‰å“çƒ­ä¿®å¤æŠ€æœ¯åŸç†ã€‹32 -</a></li>
<li><a href="/view/112.html">ğŸ“šã€Šæ·±å…¥æ¢ç´¢å®‰å“çƒ­ä¿®å¤æŠ€æœ¯åŸç†ã€‹1-32</a></li>
<li><a href="/view/82.html">ğŸ“šã€Šé€†å‘å·¥ç¨‹æƒå¨æŒ‡å—ã€‹ - 1-4ç« </a></li>
    </ul>
 <p>ç¼–ç¨‹å¼€å‘</p>
    <ul>
<li><a href="/view/111.html">ğŸŒ¹ Dobbyä½¿ç”¨</a></li>
<li><a href="/view/77.html">ğŸ“‘ã€å‰ç«¯å¼€å‘ã€‘lightbox+pjaxæœ€ä½³å®è·µ</a></li>
<li><a href="/view/71.html">ğŸ“‘ã€NDKå¼€å‘ã€‘NDKé‡‡é›†ã€å‹ç¼©ã€åŠ å¯†ä¼ è¾“è®¾å¤‡ä¿¡æ¯</a></li>
<li><a href="/view/70.html">ğŸ“‘ã€NDKå¼€å‘ã€‘åŸºç¡€ç¯å¢ƒæ­å»º</a></li>
    </ul>
 <p>é€†å‘åˆ†æ</p>
    <ul>
<li><a href="/view/86.html">âš™ï¸ ã€Xposed æ”¹æœºã€‘- åŸºç¡€ç¯å¢ƒå®‰è£…</a></li>
<li><a href="/view/81.html">ğŸ’» å®‰å“å†…è”æ±‡ç¼–å¼€å‘</a></li>
<li><a href="/view/76.html">ğŸ“‘ JNI ä½¿ç”¨åŸºç¡€</a></li>
<li><a href="/view/75.html">ğŸ“‘ IDA Debugger è°ƒè¯•å™¨ä½¿ç”¨</a></li>
<li><a href="/view/74.html">ğŸ’» std::stringå†…å­˜å¸ƒå±€</a></li>
<li><a href="/view/73.html">ğŸ’¼ Fridaä½œä¸š-20231114</a></li>
<li><a href="/view/65.html">ğŸ§® JSVMPæ‰§è¡Œæµç¨‹åˆ†æ</a></li>
    </ul>
</li>
</ul></div>
</aside><section class="content mx-auto" id="article">
        <div class="d-flex"> 


           
            <article class="markdown-section" id="main" style="word-break:break-all;">
                
                <div>
                <h1>ğŸ‘ æŸåŠ å¯†æ ·æœ¬ Traceåˆ†æ</h1>

                
                <a style="font-size:12px;color: #5f5d5d;">å¯†çº§: 
                
                                ã€<span style="color:green">C-1</span>ã€‘
                                 
                
                | æ—¶é—´: | ç›®å½•:æµ‹è¯•ç¬”è®° </a> 
                
                | 
                <a style="font-size:12px;color: #007bff;" href="http://10.8.0.4:5080/tenantadmin/Tenantarticle/quickedit/quickedit.html?id=121" target="_blank">ç¼–è¾‘æœ¬æ–‡</a>
                <br>             
                                

                    <div id="content"><textarea style="display: none;">## Unidbgæ¨¡æ‹Ÿæ‰§è¡Œ

![](https://img.meituan.net/imgupload/9f61c54e84a609da48b570b00b6e80b251967.png)

## soæ–‡ä»¶åç¼–è¯‘

è·³è½¬è¯¥åç§»ä½ç½® 

![](https://img.meituan.net/imgupload/9d0b3c9771c946a205648ec321105d0c120261.png)

å‘ç°æ–‡ä»¶åŠ å›ºäº†ï¼Œä½¿ç”¨unidbgæ‰“å°trace

![](https://img.meituan.net/imgupload/53fceb39aa95735260d41e9f3c2dec1f656023.png)

## åŸºç¡€åˆ†æ

![](https://img.meituan.net/imgupload/1227dc3257c08c4a9d9155046698ed5b63244.png)

æœ€ç»ˆçš„ç»“æœé€šè¿‡ JNIEnv->NewStringUTF("8ea60836") æ–¹æ³•è°ƒç”¨ï¼Œä½¿ç”¨äº†jniçš„æ–¹æ³•ï¼Œå…¶ä¸­å…¥å‚ä¸¤ä¸ªï¼Œç¬¬ä¸€ä¸ªæ˜¯envï¼Œç¬¬äºŒä¸ªæ˜¯8ea60836ã€‚è°ƒç”¨åœ°å€ä¸ºï¼š0x40002c37

åœ¨traceä¸­æœç´¢0x40002c37

![](https://img.meituan.net/imgupload/dfba3502a93addc14b307a1b66f66ab5681039.png)

åªæ‰¾åˆ°ä¸€å¤„ï¼Œè¿™é‡Œæ˜¯é€šè¿‡blxæŒ‡ä»¤è·³è½¬ï¼Œå®ƒå°†ä¼šå°†ç¨‹åºæ§åˆ¶è½¬ç§»åˆ°0xfffe0c30åœ°å€å¤„æ‰§è¡Œï¼Œå¹¶å°†è¿”å›åœ°å€ä¿å­˜åœ¨lrå¯„å­˜å™¨ä¸­ï¼Œè¯¥è¿”å›åœ°å€ä¸º0x40002c37ã€‚

å‰é¢æåˆ°ï¼Œè¿™ä¸ªå…¥å‚ä¸º8ea60836ï¼Œä¿å­˜åœ¨r1å¯„å­˜å™¨ä¸­ã€‚å‘ä¸Šæ‰¾èƒ½çœ‹åˆ°movæŒ‡ä»¤æ“ä½œï¼š

![](https://img.meituan.net/imgupload/2031da7f9912cda632c85b10be6dae2417613.png)

r1åœ°å€æ˜¯å…¥å‚çš„å€¼ï¼Œä»–ä¸€å®šå­˜åœ¨Memory writeçš„æ“ä½œï¼ŒæŒ‡ä»¤ç»§ç»­æœç´¢ï¼š

![](https://img.meituan.net/imgupload/29ecf0168243c52177d929483a51bd0a66334.png)

åœ¨åœ°å€0x401d7010å¤„å†™å…¥äº†ä¸€ä¸ªå­—èŠ‚å¤§å°çš„æ•°æ®ï¼Œå€¼ä¸º0x38ã€‚å½“å‰æŒ‡ä»¤çš„åœ°å€ä¸º0x40002492ã€‚

ä¸€çœ¼çœ‹0x38 == 8ï¼Œä½¿ç”¨cyberchefæŠŠ8ea60836è½¬æ¢æˆhexï¼š

![](https://img.meituan.net/imgupload/7e9cd35de946e160c29e3b8fd8fe301552246.png)

å’Œè¿™é‡Œå¯¹ä¸Šäº†

```
[08:27:44 696][libencrypt.so 0x02491] [e17d    ] 0x40002490: "ldrb r1, [r4, #0x17]" r4=0x40007050 => r1=0x38
[08:27:44 696][libencrypt.so 0x02493] [0170    ] 0x40002492: "strb r1, [r0]" r1=0x38 r0=0x401d7010[08:27:44 697] Memory WRITE at 0x401d7010, data size = 1, data value = 0x38, PC=RX@0x40002492[libencrypt.so]0x2492, LR=unidbg@0x18

[08:27:44 697][libencrypt.so 0x02495] [e17f    ] 0x40002494: "ldrb r1, [r4, #0x1f]" r4=0x40007050 => r1=0x65
[08:27:44 697][libencrypt.so 0x02497] [4170    ] 0x40002496: "strb r1, [r0, #1]" r1=0x65 r0=0x401d7010[08:27:44 697] Memory WRITE at 0x401d7011, data size = 1, data value = 0x65, PC=RX@0x40002496[libencrypt.so]0x2496, LR=unidbg@0x18

[08:27:44 697][libencrypt.so 0x02499] [a17f    ] 0x40002498: "ldrb r1, [r4, #0x1e]" r4=0x40007050 => r1=0x61
[08:27:44 697][libencrypt.so 0x0249b] [8170    ] 0x4000249a: "strb r1, [r0, #2]" r1=0x61 r0=0x401d7010[08:27:44 697] Memory WRITE at 0x401d7012, data size = 1, data value = 0x61, PC=RX@0x4000249a[libencrypt.so]0x249a, LR=unidbg@0x18

[08:27:44 697][libencrypt.so 0x0249d] [a17e    ] 0x4000249c: "ldrb r1, [r4, #0x1a]" r4=0x40007050 => r1=0x36
[08:27:44 697][libencrypt.so 0x0249f] [c170    ] 0x4000249e: "strb r1, [r0, #3]" r1=0x36 r0=0x401d7010[08:27:44 697] Memory WRITE at 0x401d7013, data size = 1, data value = 0x36, PC=RX@0x4000249e[libencrypt.so]0x249e, LR=unidbg@0x18

[08:27:44 697][libencrypt.so 0x024a1] [a17a    ] 0x400024a0: "ldrb r1, [r4, #0xa]" r4=0x40007050 => r1=0x30
[08:27:44 698][libencrypt.so 0x024a3] [0171    ] 0x400024a2: "strb r1, [r0, #4]" r1=0x30 r0=0x401d7010[08:27:44 698] Memory WRITE at 0x401d7014, data size = 1, data value = 0x30, PC=RX@0x400024a2[libencrypt.so]0x24a2, LR=unidbg@0x18

[08:27:44 698][libencrypt.so 0x024a5] [a17d    ] 0x400024a4: "ldrb r1, [r4, #0x16]" r4=0x40007050 => r1=0x38
[08:27:44 698][libencrypt.so 0x024a7] [4171    ] 0x400024a6: "strb r1, [r0, #5]" r1=0x38 r0=0x401d7010[08:27:44 698] Memory WRITE at 0x401d7015, data size = 1, data value = 0x38, PC=RX@0x400024a6[libencrypt.so]0x24a6, LR=unidbg@0x18

[08:27:44 698][libencrypt.so 0x024a9] [e179    ] 0x400024a8: "ldrb r1, [r4, #7]" r4=0x40007050 => r1=0x33
[08:27:44 698][libencrypt.so 0x024ab] [8171    ] 0x400024aa: "strb r1, [r0, #6]" r1=0x33 r0=0x401d7010[08:27:44 698] Memory WRITE at 0x401d7016, data size = 1, data value = 0x33, PC=RX@0x400024aa[libencrypt.so]0x24aa, LR=unidbg@0x18

[08:27:44 698][libencrypt.so 0x024ad] [617b    ] 0x400024ac: "ldrb r1, [r4, #0xd]" r4=0x40007050 => r1=0x36
[08:27:44 698][libencrypt.so 0x024af] [c171    ] 0x400024ae: "strb r1, [r0, #7]" r1=0x36 r0=0x401d7010[08:27:44 698] Memory WRITE at 0x401d7017, data size = 1, data value = 0x36, PC=RX@0x400024ae[libencrypt.so]0x24ae, LR=unidbg@0x18
```

å¯ä»¥çœ‹åˆ°éƒ½åœ¨å¾€0x40007050 åœ°å€ä¸Šå–æ•°æ®ï¼Œæ‰€ä»¥å¾—çœ‹ä»€ä¹ˆæ—¶å€™å¾€è¿™ä¸ªåœ°å€ä¸Šå†™æ•°æ®ã€‚æ•°æ®æ˜¯è¿™ä¹ˆå–çš„ï¼š

```
str = tmp[0x17]+tmp[0x1f]+tmp[0x1e]+tmp[0x1a]+tmp[0xa]+tmp[0x16]+tmp[0x7]+tmp[0xd] # 8ea60836
```

å†™å…¥ä¸€å®šæ¯”è¿™è¡Œtraceæ—©ï¼Œè¿›è¡Œåˆ†å‰²ï¼Œç„¶åæœç´¢0x40007050ï¼š

![](https://img.meituan.net/imgupload/21f64a434d04e14c24c326c1562db183259007.png)

å‘ç°æœ‰ä¸€æ®µmemory writeçš„æ“ä½œï¼ŒæŠŠè¿™æ®µtrace å¤åˆ¶ä¸‹æ¥ï¼š

![](https://img.meituan.net/imgupload/d83d41c7b20a83df8b1b44bfc9b756b8493638.png)

r0ä»0å¼€å§‹ï¼Œå¢åŠ ç«‹å³æ•°1ï¼Œæ— æ¡ä»¶è·³è½¬åˆ°æ¯”è¾ƒå‡½æ•°ï¼Œæ¯”è¾ƒr0æ˜¯å¦ä¸º0x20ï¼ˆ32ï¼‰ï¼Œå¦‚æœç›¸ç­‰å°±è·³è½¬ åˆ°0x400020b4ã€‚å¦åˆ™å°±ldrb åŠ è½½æŸä¸ªå†…å­˜åœ°å€ï¼ˆ0xbffff650ï¼‰+ç´¢å¼•å€¼ï¼ˆr0ï¼‰åˆ°å¯„å­˜å™¨r2ï¼Œç„¶åå†strb å†™å…¥è¿™ä¸ªr2çš„å€¼ï¼Œåˆ°0x40007050åœ°å€+ç´¢å¼•å€¼ï¼ˆr0ï¼‰çš„ä½ç½®ã€‚

æ‰€ä»¥å¾ˆç®€å•å§ï¼Œå†…å­˜æ‹·è´ã€‚æ‹·è´çš„å€¼æ˜¯ï¼š
```
66 66 39 63 38 65 39 33 30 37 30 62 38 36 62 32 39 36 31 35 39 33 38 38 61 34 36 38 37 63 61 65
ff9c8e93070b86b296159388a4687cae
```
é‚£ä¹ˆæ¥ç€å°±æ˜¯çœ‹0xbffff650 è¿™ä¸ªåœ°å€:

![](https://img.meituan.net/imgupload/a6c27ad7f132730364710de441970e4590084.png)

å‘ç”Ÿäº†memory copyï¼Œç½‘ä¸Šæ‰¾æœ€è¿‘çš„æ±‡ç¼–æŒ‡ä»¤ï¼ˆlibcä¸­çš„æŒ‡ä»¤æ²¡æœ‰è¢«è®°å½•ï¼‰

![](https://img.meituan.net/imgupload/8a93c13028513dd8ecc524634707934b80110.png)

æ ¹æ®å®šä¹‰ï¼Œå‚æ•°2ä»£è¡¨è¦å¤åˆ¶çš„å†…å­˜åŒºåŸŸï¼Œä¹Ÿå°±æ˜¯å¯„å­˜å™¨r1

![](https://img.meituan.net/imgupload/ab79692c71ac2eba1e9a28fd86e44d4643407.png)

å¾€ä¸Šå°±å¾ˆéš¾è·Ÿäº†ï¼Œä½†æ˜¯æˆ‘ä»¬é€šè¿‡å‰é¢æ‹¿åˆ°äº†å†…å­˜é‡Œçš„å€¼ff9c8e93070b86b296159388a4687caeï¼Œå‡å®šä»–æ˜¯4å­—èŠ‚ä¸€ç»„è¿›è¡ŒåŠ å¯†ï¼Œå°ç«¯åºï¼Œç¬¬ä¸€ç»„åº”è¯¥æ˜¯938e9cffã€‚

![](https://img.meituan.net/imgupload/675a05ee0735a1d36c36c6cb0d6a8a45203872.png)

æ‰¾åˆ°äº†æœ€æ—©ç”Ÿæˆçš„åœ°æ–¹

```
[08:27:44 420][libencrypt.so 0x01e53] [0360    ] 0x40001e52: "str r3, [r0]" r3=0x938e9cff r0=0xbffff680[08:27:44 420] Memory WRITE at 0xbffff680, data size = 4, data value = 0x938e9cff, PC=RX@0x40001e52[libencrypt.so]0x1e52, LR=null

[08:27:44 420][libencrypt.so 0x01e55] [62ea0503] 0x40001e54: "orn r3, r2, r5" r2=0x2c4979fe r5=0xfac46ee8 => r3=0x2d7bf9ff
[08:27:44 420][libencrypt.so 0x01e59] [4b40    ] 0x40001e58: "eors r3, r1" r3=0x2d7bf9ff r1=0xb3fbb84f => r3=0x9e8041b0
[08:27:44 421][libencrypt.so 0x01e5b] [5d44    ] 0x40001e5a: "add r5, fp" r5=0xfac46ee8 fp=0x31313339 => r5=0x2bf5a221
[08:27:44 421][libencrypt.so 0x01e5d] [2344    ] 0x40001e5c: "add r3, r4" r3=0x9e8041b0 r4=0x30614c41 => r3=0xcee18df1
[08:27:44 421][libencrypt.so 0x01e5f] [3f4c    ] 0x40001e5e: "ldr r4, [pc, #0xfc]" => r4=0xbd3af235
[08:27:44 421][libencrypt.so 0x01e61] [2344    ] 0x40001e60: "add r3, r4" r3=0xcee18df1 r4=0xbd3af235 => r3=0x8c1c8026
[08:27:44 421][libencrypt.so 0x01e63] [059c    ] 0x40001e62: "ldr r4, [sp, #0x14]" sp=0xbffff540 => r4=0x10325476
[08:27:44 422][libencrypt.so 0x01e65] [02ebb353] 0x40001e64: "add.w r3, r2, r3, ror #22" r2=0x2c4979fe r3=0x8c1c8026 => r3=0x9e4a142e
[08:27:44 422][libencrypt.so 0x01e69] [1c44    ] 0x40001e68: "add r4, r3" r4=0x10325476 r3=0x9e4a142e => r4=0xae7c68a4
[08:27:44 422][libencrypt.so 0x01e6b] [c460    ] 0x40001e6a: "str r4, [r0, #0xc]" r4=0xae7c68a4 r0=0xbffff680[08:27:44 422] Memory WRITE at 0xbffff68c, data size = 4, data value = 0xae7c68a4, PC=RX@0x40001e6a[libencrypt.so]0x1e6a, LR=null

[08:27:44 422][libencrypt.so 0x01e6d] [63ea0104] 0x40001e6c: "orn r4, r3, r1" r3=0x9e4a142e r1=0xb3fbb84f => r4=0xde4e57be
[08:27:44 422][libencrypt.so 0x01e71] [7144    ] 0x40001e70: "add r1, lr" r1=0xb3fbb84f lr=0x0 => r1=0xb3fbb84f
[08:27:44 423][libencrypt.so 0x01e73] [5440    ] 0x40001e72: "eors r4, r2" r4=0xde4e57be r2=0x2c4979fe => r4=0xf2072e40
[08:27:44 423][libencrypt.so 0x01e75] [2c44    ] 0x40001e74: "add r4, r5" r4=0xf2072e40 r5=0x2bf5a221 => r4=0x1dfcd061
[08:27:44 423][libencrypt.so 0x01e77] [3a4d    ] 0x40001e76: "ldr r5, [pc, #0xe8]" => r5=0x2ad7d2bb
[08:27:44 423][libencrypt.so 0x01e79] [2c44    ] 0x40001e78: "add r4, r5" r4=0x1dfcd061 r5=0x2ad7d2bb => r4=0x48d4a31c
[08:27:44 423][libencrypt.so 0x01e7b] [089d    ] 0x40001e7a: "ldr r5, [sp, #0x20]" sp=0xbffff540 => r5=0x98badcfe
[08:27:44 424][libencrypt.so 0x01e7d] [03eb7444] 0x40001e7c: "add.w r4, r3, r4, ror #17" r3=0x9e4a142e r4=0x48d4a31c => r4=0xefd83898
[08:27:44 424][libencrypt.so 0x01e81] [64ea0202] 0x40001e80: "orn r2, r4, r2" r4=0xefd83898 r2=0x2c4979fe => r2=0xfffebe99
[08:27:44 424][libencrypt.so 0x01e85] [2544    ] 0x40001e84: "add r5, r4" r5=0x98badcfe r4=0xefd83898 => r5=0x88931596
[08:27:44 424][libencrypt.so 0x01e87] [5a40    ] 0x40001e86: "eors r2, r3" r2=0xfffebe99 r3=0x9e4a142e => r2=0x61b4aab7
[08:27:44 424][libencrypt.so 0x01e89] [8560    ] 0x40001e88: "str r5, [r0, #8]" r5=0x88931596 r0=0xbffff680[08:27:44 424] Memory WRITE at 0xbffff688, data size = 4, data value = 0x88931596, PC=RX@0x40001e88[libencrypt.so]0x1e88, LR=null

[08:27:44 424][libencrypt.so 0x01e8b] [1144    ] 0x40001e8a: "add r1, r2" r1=0xb3fbb84f r2=0x61b4aab7 => r1=0x15b06306
[08:27:44 425][libencrypt.so 0x01e8d] [354a    ] 0x40001e8c: "ldr r2, [pc, #0xd4]" => r2=0xeb86d391
[08:27:44 425][libencrypt.so 0x01e8f] [099d    ] 0x40001e8e: "ldr r5, [sp, #0x24]" sp=0xbffff540 => r5=0xefcdab89
[08:27:44 425][libencrypt.so 0x01e91] [1144    ] 0x40001e90: "add r1, r2" r1=0x15b06306 r2=0xeb86d391 => r1=0x1373697
[08:27:44 425][libencrypt.so 0x01e93] [2544    ] 0x40001e92: "add r5, r4" r5=0xefcdab89 r4=0xefd83898 => r5=0xdfa5e421
[08:27:44 425][libencrypt.so 0x01e95] [05ebf121] 0x40001e94: "add.w r1, r5, r1, ror #11" r5=0xdfa5e421 r1=0x1373697 => r1=0xb2860b07
[08:27:44 426][libencrypt.so 0x01e99] [4160    ] 0x40001e98: "str r1, [r0, #4]" r1=0xb2860b07 r0=0xbffff680[08:27:44 426] Memory WRITE at 0xbffff684, data size = 4, data value = 0xb2860b07, 
```

é€šè¿‡write atçš„é¡ºåº

1ã€0x938e9cff
2ã€0xb2860b07
3ã€0x88931596
4ã€0xae7c68a4

æ³¨æ„å°ç«¯åºï¼Œæ‹¼èµ·æ¥å°±æ˜¯ä¸Šé¢çš„å€¼ã€‚16ä¸ªå­—èŠ‚ï¼Œå››ä¸ªå­—èŠ‚ä¸€ç»„è¿›è¡Œæ‹¼æ¥ï¼Œæ˜¯ä¸æ˜¯å¾ˆåƒmd5ï¼Œå¦‚ä½•åˆ†æï¼Ÿ

## åˆ†ææ˜¯å¦ä¸ºé­”æ”¹md5

### æ ‡å‡†ä¼ªä»£ç 
æ ‡å‡†md5çš„ä¼ªä»£ç å¦‚ä¸‹ï¼š

```
// : All variables are unsigned 32 bit and wrap modulo 2^32 when calculating
var int s[64], K[64]
var int i

// s specifies the per-round shift amounts
s[ 0..15] := { 7, 12, 17, 22,  7, 12, 17, 22,  7, 12, 17, 22,  7, 12, 17, 22 }
s[16..31] := { 5,  9, 14, 20,  5,  9, 14, 20,  5,  9, 14, 20,  5,  9, 14, 20 }
s[32..47] := { 4, 11, 16, 23,  4, 11, 16, 23,  4, 11, 16, 23,  4, 11, 16, 23 }
s[48..63] := { 6, 10, 15, 21,  6, 10, 15, 21,  6, 10, 15, 21,  6, 10, 15, 21 }

// Use binary integer part of the sines of integers (Radians) as constants:
for i from 0 to 63 do
    K[i] := floor(232 Ã— abs(sin(i + 1)))
end for
// (Or just use the following precomputed table):
K[ 0.. 3] := { 0xd76aa478, 0xe8c7b756, 0x242070db, 0xc1bdceee }
K[ 4.. 7] := { 0xf57c0faf, 0x4787c62a, 0xa8304613, 0xfd469501 }
K[ 8..11] := { 0x698098d8, 0x8b44f7af, 0xffff5bb1, 0x895cd7be }
K[12..15] := { 0x6b901122, 0xfd987193, 0xa679438e, 0x49b40821 }
K[16..19] := { 0xf61e2562, 0xc040b340, 0x265e5a51, 0xe9b6c7aa }
K[20..23] := { 0xd62f105d, 0x02441453, 0xd8a1e681, 0xe7d3fbc8 }
K[24..27] := { 0x21e1cde6, 0xc33707d6, 0xf4d50d87, 0x455a14ed }
K[28..31] := { 0xa9e3e905, 0xfcefa3f8, 0x676f02d9, 0x8d2a4c8a }
K[32..35] := { 0xfffa3942, 0x8771f681, 0x6d9d6122, 0xfde5380c }
K[36..39] := { 0xa4beea44, 0x4bdecfa9, 0xf6bb4b60, 0xbebfbc70 }
K[40..43] := { 0x289b7ec6, 0xeaa127fa, 0xd4ef3085, 0x04881d05 }
K[44..47] := { 0xd9d4d039, 0xe6db99e5, 0x1fa27cf8, 0xc4ac5665 }
K[48..51] := { 0xf4292244, 0x432aff97, 0xab9423a7, 0xfc93a039 }
K[52..55] := { 0x655b59c3, 0x8f0ccc92, 0xffeff47d, 0x85845dd1 }
K[56..59] := { 0x6fa87e4f, 0xfe2ce6e0, 0xa3014314, 0x4e0811a1 }
K[60..63] := { 0xf7537e82, 0xbd3af235, 0x2ad7d2bb, 0xeb86d391 }

// Initialize variables:
var int a0 := 0x67452301   // A
var int b0 := 0xefcdab89   // B
var int c0 := 0x98badcfe   // C
var int d0 := 0x10325476   // D

// Pre-processing: adding a single 1 bit
append "1" bit to message<    
 // Notice: the input bytes are considered as bit strings,
 //  where the first bit is the most significant bit of the byte.[53]

// Pre-processing: padding with zeros
append "0" bit until message length in bits â‰¡ 448 (mod 512)

// Notice: the two padding steps above are implemented in a simpler way
  //  in implementations that only work with complete bytes: append 0x80
  //  and pad with 0x00 bytes so that the message length in bytes â‰¡ 56 (mod 64).

append original length in bits mod 264 to message

// Process the message in successive 512-bit chunks:
for each 512-bit chunk of padded message do
    break chunk into sixteen 32-bit words M[j], 0 â‰¤ j â‰¤ 15
    // Initialize hash value for this chunk:
    var int A := a0
    var int B := b0
    var int C := c0
    var int D := d0
    // Main loop:
    for i from 0 to 63 do
        var int F, g
        if 0 â‰¤ i â‰¤ 15 then
            F := (B and C) or ((not B) and D)
            g := i
        else if 16 â‰¤ i â‰¤ 31 then
            F := (D and B) or ((not D) and C)
            g := (5Ã—i + 1) mod 16
        else if 32 â‰¤ i â‰¤ 47 then
            F := B xor C xor D
            g := (3Ã—i + 5) mod 16
        else if 48 â‰¤ i â‰¤ 63 then
            F := C xor (B or (not D))
            g := (7Ã—i) mod 16
        // Be wary of the below definitions of a,b,c,d
        F := F + A + K[i] + M[g]  // M[g] must be a 32-bit block
        A := D
        D := C
        C := B
        B := B + leftrotate(F, s[i])
    end for
    // Add this chunk's hash to result so far:
    a0 := a0 + A
    b0 := b0 + B
    c0 := c0 + C
    d0 := d0 + D
end for

var char digest[16] := a0 append b0 append c0 append d0 // (Output is in little-endian)
```

### æ ‡å‡†md5çš„å¤„ç†æµç¨‹

1ã€å¡«å……

å½“ K%512 ç­‰äº 448
å¦‚æœåŸå§‹æ¶ˆæ¯çš„é•¿åº¦ K æ¨¡ 512 æ­£å¥½ç­‰äº 448ï¼Œè¿™æ„å‘³ç€åœ¨å½“å‰çš„æ¶ˆæ¯å—ä¸­ï¼Œå·²ç»æ°å¥½æœ‰ 448 ä½ï¼Œåªå‰©ä¸‹ 64 ä½ç©ºé—´ç”¨äºå­˜æ”¾æ¶ˆæ¯çš„é•¿åº¦ã€‚æŒ‰ç…§é™„åŠ å¡«å……ä½çš„è§„åˆ™ï¼Œè‡³å°‘éœ€è¦å¡«å…… 1 ä½ã€‚ç”±äºæ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—´åœ¨å½“å‰å—ä¸­å®Œæˆå¡«å……å’Œå­˜æ”¾é•¿åº¦ä¿¡æ¯ï¼Œå› æ­¤éœ€è¦æ·»åŠ ä¸€ä¸ªæ–°çš„ 512 ä½å—ã€‚è¿™ä¸ªæ–°å—çš„å‰ 1 ä½æ˜¯ 1ï¼Œåé¢çš„ 511 ä½æ˜¯ 0ã€‚

å½“ K%512 åœ¨ [448, 512) ä¹‹é—´
å¦‚æœåŸå§‹æ¶ˆæ¯çš„é•¿åº¦ K æ¨¡ 512 è½åœ¨ 448 åˆ° 512 ä¹‹é—´ï¼ˆä¸åŒ…æ‹¬ 512ï¼Œå› ä¸ºæ¨¡ 512 ç­‰äº 0 æ„å‘³ç€æ­£å¥½æ˜¯å—çš„è¾¹ç•Œï¼‰ï¼Œè¿™æ„å‘³ç€å½“å‰å—ä¸ä»…å·²ç»è¶…è¿‡äº†å¯ä»¥å¡«å……ä½çš„ç©ºé—´ï¼Œè€Œä¸”è¿˜ä¸è¶³ä»¥å­˜æ”¾ 64 ä½çš„é•¿åº¦ä¿¡æ¯ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¹Ÿéœ€è¦æ·»åŠ ä¸€ä¸ªæ–°çš„ 512 ä½å—ï¼Œå…¶ä¸­å¡«å……ä½çš„é•¿åº¦æ˜¯ 512 - (K%512 - 448)ï¼Œå³å¡«å……ä½å¼€å§‹äºæ–°å—çš„ç¬¬ä¸€ä½ï¼Œå¹¶ä¸”ç¬¬ä¸€ä½æ˜¯ 1ï¼Œå…¶ä½™ç›´åˆ°æ–°å—çš„ 448 ä½éƒ½æ˜¯ 0ã€‚

å½“ K%512 å°äº 448
å¦‚æœåŸå§‹æ¶ˆæ¯çš„é•¿åº¦ K æ¨¡ 512 å°äº 448ï¼Œè¿™æ„å‘³ç€åœ¨å½“å‰å—ä¸­æœ‰è¶³å¤Ÿçš„ç©ºé—´æ¥å¡«å……ä½ï¼Œå¹¶ä¸”è¿˜èƒ½å­˜æ”¾ 64 ä½çš„é•¿åº¦ä¿¡æ¯ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¡«å……ä½çš„é•¿åº¦æ˜¯ 448 - K%512ã€‚å¡«å……å¼€å§‹äºåŸå§‹æ¶ˆæ¯ä¹‹åçš„ç¬¬ä¸€ä½ï¼Œä¸”è¿™ä¸€ä½æ˜¯ 1ï¼Œåé¢è·Ÿéšè¶³å¤Ÿçš„ 0 ä½ï¼Œç›´åˆ°æ•´ä¸ªæ¶ˆæ¯çš„é•¿åº¦è¾¾åˆ° 448 ä½çš„å€æ•°ã€‚

æ— è®ºåŸå§‹æ¶ˆæ¯çš„é•¿åº¦å¦‚ä½•ï¼Œå¡«å……ä½çš„é™„åŠ æ€»æ˜¯ç¡®ä¿æ¶ˆæ¯çš„æ€»é•¿åº¦æ˜¯ 512 ä½çš„å€æ•°ï¼Œä¸”æœ€åä¸€ä¸ª 512 ä½å—æœ‰ 64 ä½ç”¨äºå­˜æ”¾åŸå§‹æ¶ˆæ¯çš„é•¿åº¦ï¼ˆé€šå¸¸æ˜¯ä»¥äºŒè¿›åˆ¶è¡¨ç¤ºçš„ä½æ•°ï¼‰ã€‚è¿™æ ·çš„è®¾è®¡å…è®¸æ¶ˆæ¯æ‘˜è¦ç®—æ³•ï¼ˆå¦‚ MD5ï¼ŒSHA-1ï¼ŒSHA-256 ç­‰ï¼‰èƒ½å¤Ÿæ­£ç¡®å¤„ç†å¹¶ç”Ÿæˆå›ºå®šé•¿åº¦çš„æ•£åˆ—å€¼ã€‚

![](https://img.meituan.net/imgupload/568d76e9f4f8de7b90e1ed70eb2741fc196886.png)

2ã€åˆå§‹åŒ–MDç¼“å†²åŒº

3ã€Process Message in 16-Word Blocks å¤„ç†æ¶ˆæ¯ç»„

æ€»çš„æ¥è¯´å°±æ˜¯ï¼Œå…ˆæ ¹æ®512bité•¿åº¦åˆ†å‰²å¡«å……åçš„æ•°æ®ï¼Œå†æŠŠæ¯ä¸ªblockè¿›è¡Œ32bitè¿›è¡Œåˆ†å‰²ï¼Œæ¯32bitsæ˜æ–‡æ•°æ®ä¸ºä¸€ä¸ªå•ä½ï¼Œè¦è¿›è¡Œ4è½®çš„å‘é‡è¿ç®—ï¼›è€Œæ¯ä¸€ä¸ªblockè¦å¯¹16ä¸ªï¼ˆ32bitsï¼‰å•ä½æ˜æ–‡æ•°æ®è¿›è¡Œè¿ç®—ï¼Œå…±è®¡64æ¬¡ã€‚

MD Bufferå°±æ˜¯Aã€Bã€Cã€Dï¼ŒMD5çš„æ ¸å¿ƒå°±æ˜¯ä¸æ–­å¯¹MD Bufferåšçº¿æ€§ã€éçº¿æ€§å‘é‡å˜æ¢ï¼Œæœ€ç»ˆå¾—åˆ°æ¶ˆæ¯æ‘˜è¦ã€‚

### çº¯å‡€md5ç®—æ³•

![](https://img.meituan.net/imgupload/88b1bb2e7d25deec049ea9cffe7c96e8215983.png)

åœ¨traceä¸­èƒ½çœ‹è§å¤§é‡md5ä¸­çš„kè¡¨çš„å€¼ï¼Œä½†æ˜¯ä¸ä¸€å®šæ²¡æœ‰ç»è¿‡é­”æ”¹ï¼Œæœ‰å¯èƒ½å¯¹kè¡¨åšäº†é¡ºåºè°ƒæ•´å•¥çš„ã€‚

![](https://img.meituan.net/imgupload/6a6daf01041a4cd831a929875ba38086113606.png)

åœ¨traceæŸå¤„ï¼Œè¿ç»­å†™å…¥å››ä¸ªå€¼ï¼Œåˆšå¥½æ˜¯md5çš„Bufferã€‚

å¯ä»¥æœç´¢åˆ°Kè¡¨ä¸­çš„å€¼ä»¥åŠé­”æ•°ï¼Œæ‰€ä»¥å¯ä»¥æ–­å®šæ˜¯ä¸€ä¸ªMD5æˆ–è€…MD5çš„é­”æ”¹ç‰ˆæœ¬ã€‚



### æ‰¾åˆ°ç®—æ³•çš„è¾“å‡º

![](https://img.meituan.net/imgupload/db340c96ff12f2858f3a2bad1572200b28174.png)

æ ‡å‡†ç®—æ³•ä¸­ï¼Œæœ€åè¾“å‡ºç»“æœæ˜¯é­”æ•°+äº§ç”Ÿçš„å€¼å†æ‹¼æ¥ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡é­”æ•°æ¥æ‰¾åˆ°æœ€åä¸è°åšäº†ç›¸åŠ ï¼Ÿç®—å‡ºçš„ç»“æœå°±æ˜¯åŠ å¯†ç»“æœçš„ä¸€éƒ¨åˆ†ï¼Œé¦–å…ˆçœ‹0x67452301ï¼š

![](https://img.meituan.net/imgupload/ba98518a1d1183b10a8313b54d9e6ed050130.png)

è¿™è¿˜æ²¡å®Œï¼Œä½ ä»¥ä¸ºæ˜¯ç»“æœå—ï¼Ÿç”±äºmd5å¯èƒ½ä¼šåšå¤šè½®åˆ†ç»„è¿ç®—ï¼Œæ‰€ä»¥å¾—æœä¸€ä¸‹è¿™ä¸ªç»“æœæ˜¯å¦å‚ä¸åç»­è¿ç®—ï¼Ÿï¼ˆç»“æœå°±æ˜¯æ–°çš„é­”æ•°ï¼Œå‚ä¸åˆ°ä¸‹ä¸€ä¸ªå¾ªç¯ï¼‰å¦‚æœæ‰¾åˆ°äº†ï¼Œè¯´æ˜æ˜æ–‡é•¿åº¦è¶…è¿‡äº†ä¸€ä¸ªåˆ†ç»„é•¿ï¼Œç»§ç»­åšäº†è¿ç®—ï¼Œä½†æ˜¯ä¸€æ ·çš„ï¼Œä¹Ÿæ˜¯æœ€åè¿›è¡Œäº†ç›¸åŠ ã€‚

![](https://img.meituan.net/imgupload/b320eb07e9e710fbc0f4348f043723e8186481.png)

å‘ç°æ²¡æœ‰äº†ï¼Œåªåšäº†ä¸€ä¸ªåˆ†ç»„çš„åŠ å¯†ã€‚å°ç«¯åºï¼Œç»“æœå°±æ˜¯ï¼š

ff9c8e93

åŒç†ï¼Œæ‰¾åˆ°ç¬¬äºŒä¸ªé­”æ•°å’Œè°ç›¸åŠ ï¼Ÿ

![](https://img.meituan.net/imgupload/816387d3394c90db4c2a089dd53a160470434.png)

ff9c8e93 070b86b2 

```
[08:27:44 424][libencrypt.so 0x01e85] [2544    ] 0x40001e84: "add r5, r4" r5=0x98badcfe r4=0xefd83898 => r5=0x88931596

[08:27:44 422][libencrypt.so 0x01e69] [1c44    ] 0x40001e68: "add r4, r3" r4=0x10325476 r3=0x9e4a142e => r4=0xae7c68a4

```

ff9c8e93 070b86b2  96159388 a4687cae

è¿™å°±æ˜¯ç»“æœçš„å¯†æ–‡ã€‚å’Œå‰æ–‡é€šè¿‡traceåˆ†ææ‹¿åˆ°çš„å®Œå…¨ä¸€è‡´ã€‚

### æ‰¾åˆ°ç®—æ³•çš„è¾“å…¥

å‰é¢æœç´¢é­”æ•°çš„æ—¶å€™ï¼Œåœ¨traceå¯ä»¥çœ‹åˆ°åˆ†å¸ƒï¼š

![](https://img.meituan.net/imgupload/d7d002f05549b775e3a0d0dd8674c23a38687.png)

è¯´æ˜traceç”¨åˆ°äº†ä¸‰æ¬¡çš„md5ï¼Œè€Œæˆ‘ä»¬å‡ºç»“æœçš„æ˜¯åœ¨é åé¢çš„ä½ç½®ï¼š

![](https://img.meituan.net/imgupload/6866387692b8d0ddcbb9ee7d10fd99ca45304.png)

ä¸ºäº†æ’é™¤å¹²æ‰°ï¼Œå¯ä»¥æŠŠå‰é¢çš„traceå»æ‰ï¼Œé˜²æ­¢ç”±äºå¤šæ¬¡md5é€ æˆå½±å“ã€‚

![](https://img.meituan.net/imgupload/b8060456f57469b5091043f44da60b92136559.png)

Mä¹Ÿå°±æ˜¯å°†å¡«å……åçš„æ˜æ–‡è¿›è¡Œ4å­—èŠ‚ä¸€ç»„è¿›è¡Œåˆ†å‰²ï¼Œç„¶åè¿›å…¥FFå‡½æ•°è¿›è¡Œéçº¿æ€§å˜åŒ–ã€‚

![](https://img.meituan.net/imgupload/48d069c18720d5e1b98a199142fbb9ea22454.png)

FFå‡½æ•°ä¸­ï¼ŒMæ˜¯ä»¥åŠ æ³•çš„æ–¹å¼è¿›è¡Œæ“ä½œçš„ã€‚è¿˜ä¼šå’Œtè¿›è¡Œç›¸åŠ ï¼Œä¹Ÿå°±æ˜¯kè¡¨ä¸­å€¼ã€‚æ ¹æ®è¿™ä¸ªç‰¹ç‚¹ï¼Œå»traceä¸­å¯»æ‰¾ï¼Œkè¡¨å…ƒç´ è¢«ç›¸åŠ çš„ä½ç½®ï¼ˆå‰16ä¸ªï¼‰å°±èƒ½æŠŠå…¥å‚è·å–ã€‚é¦–å…ˆè¾“å…¥kè¡¨çš„ç¬¬ä¸€ä¸ªï¼š

![](https://img.meituan.net/imgupload/d343f29bf23840e755c0a35fcbc1f1d5142327.png)

æ‰€ä»¥åªéœ€è¦è§‚å¯Ÿ3wåä¹‹åçš„å°±è¡Œäº†ï¼Œæ­¤æ—¶çš„r1å¯„å­˜å™¨çš„å€¼å°±æ˜¯

a + F(b, c, d) + Mçš„ç»“æœï¼Œæ‰€ä»¥å¾€ä¸Šçœ‹å…¶ä»–çš„addæ“ä½œï¼š

![](https://img.meituan.net/imgupload/fdfe4767ec81dea160122c184146a61227202.png)

è¯´æ˜m[0]å°±æ˜¯ 0x32353533ï¼Œä¹Ÿå°±æ˜¯è¾“å…¥çš„å‰å››ä¸ªå­—èŠ‚ã€‚è¿™é‡Œä¸éš¾å‘ç°ï¼Œa + F(b, c, d) ç¬¬ä¸€æ¬¡è®¡ç®—çš„ç»“æœæ˜¯éå¸¸ç‰¹æ®Šçš„0xffffffffï¼ŒçŸ¥é“è¿™ä¸ªæŠ€å·§åï¼Œåç»­å¯ä»¥ç”¨è¿™ä¸ªå½“ä½œé”šç‚¹æ¥å®šä½ç¬¬ä¸€è½®çš„è¿ç®—ã€‚

![](https://img.meituan.net/imgupload/747fbf6b8dcf7b67b552a99b16f31924221138.png)

æ¥ç€æ¢kå€¼æœå°±å¯ä»¥äº†ï¼Œæ¯”å¦‚ç¬¬äºŒä¸ªï¼š

![](https://img.meituan.net/imgupload/839a57f6d26460c2ac898b9e78e17565239974.png)

è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œåœ¨traceé‡Œï¼Œç¬¬ä¸€ä¸ªkè¡¨å€¼è¿ç®—ï¼Œå…ˆè®¡ç®—Fï¼Œå†ç®—a+Fï¼Œå†ç®—a+F+[m0]ï¼Œæœ€ååŠ ä¸Šk[0]ã€‚

ä½†æ˜¯ç¬¬äºŒä¸ªå€¼æ˜¯å…ˆç®—a+[m1]å†åŠ ä¸ŠFã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ

æŸ¥çœ‹opensslé‡Œçš„æºä»£ç å®šä¹‰ï¼šhttps://github.com/Chronic-Dev/openssl/blob/master/crypto/md5/md5_locl.h

![](https://img.meituan.net/imgupload/029b6f21f7878128752d3123f7a39c7f22611.png)

å‘ç°è¿™ä¸ªå‡½æ•°æ˜¯å®å®šä¹‰ï¼Œåœ¨ç¼–è¯‘å™¨å†…ä¼šè¿›è¡Œä¼˜åŒ–ã€‚æ‰€ä»¥ä¸ä¼šåƒå‡½æ•°è¡¨è¾¾å¼ä¸€æ ·ï¼Œä»å·¦åˆ°å³çš„å¢åŠ é¡ºåºã€‚æŸ¥æ‰¾æ—¶ï¼Œå¯èƒ½ä¼šé€ æˆä¸€ç‚¹å›°æ‰°ã€‚è¿™ä¸ªæ—¶å€™å°±æœ‰ä¸ªé—®é¢˜äº†ï¼Œä½ å¦‚ä½•åŒºåˆ†aå’Œmçš„å€¼ï¼Œè°æ˜¯è°ï¼Ÿ

åœ¨ç¬¬ä¸€æ­¥ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“æ‰€æœ‰çš„abcdï¼Œè¿ç®—ç»“æŸåæˆ‘ä»¬ä¹ŸçŸ¥é“æ‰€æœ‰çš„abcdã€‚

![](https://img.meituan.net/imgupload/239ff5b2e96342e918ca29e9fa586fa2367829.png)

ä¸€æ­¥æ­¥å¾€ä¸‹åˆ†æï¼Œæˆ‘ä»¬éƒ½åº”è¯¥çŸ¥é“æ‰€æœ‰çš„abcdã€‚

![](https://img.meituan.net/imgupload/839a57f6d26460c2ac898b9e78e17565239974.png)

æŒ‰ç…§è¿™æ ·çš„æ–¹æ³•ï¼Œå¯ä»¥æ‹¿åˆ°æ˜æ–‡å…¥å‚ï¼š

0x32353533
0x32323937
0x31313339
0x31313131
0x30333031
0x7c643830
0x2c392a3d

....
0x80 (è¿™ä¸ªæ—¶å€™éœ€è¦æ³¨æ„ å¯èƒ½æ˜¯å¡«å……å¼€å§‹)
.....
0x0
...
0x100 ï¼ˆçªç„¶ä¸æ˜¯0x0äº†ï¼Œå¯èƒ½æ˜¯é•¿åº¦å†™å…¥ï¼‰

å°ç«¯åºï¼Œç¿»è½¬ä¸€ä¸‹ï¼Œè¾“å…¥æ˜¯è¿™æ ·çš„hexï¼š

33353532373932323933313131313131313033303038647c3d2a392c65732e758000000000000000000000000000000000000000000000000001000000000000ã€‚

æ ¹æ®æœ«å°¾çš„é•¿åº¦ä½ï¼ˆ8å­—èŠ‚ï¼‰ï¼Œå°±æ˜¯0x100ï¼ˆå°ç«¯åºï¼Œ256ï¼‰ï¼Œå¤„ä»¥8å°±æ˜¯32å­—èŠ‚ã€‚å°±æ˜¯å–å‰32å­—èŠ‚å½“ä½œæ˜æ–‡ï¼Œä¹Ÿå°±æ˜¯ï¼š

33353532373932323933313131313131313033303038647c3d2a392c65732e75ï¼Œåˆšå¥½åœ¨80å‰é¢ã€‚

![](https://img.meituan.net/imgupload/624e350663f36ca572b6c9f6edf974b429127.png)

![](https://img.meituan.net/imgupload/ef2bd9809749221152defb63a1f1dd7084761.png)

è¿™æ ·ï¼Œåªé€šè¿‡ä¸€ä»½traceï¼Œå°±èƒ½æ‹¿åˆ°è¾“å…¥å’Œè¾“å‡ºï¼Œå¹¶ä¸”çŸ¥é“ä»–æ˜¯ä¸€ä¸ªæ²¡æœ‰è¢«é­”æ”¹çš„md5ã€‚

## ç®—æ³•å®ç°

é€šè¿‡ä¸Šé¢ï¼Œå¯ä»¥å†™å‡ºä¸€ä»½pythonä»£ç 

![](https://img.meituan.net/imgupload/5b9a72ed334c2201f009fc1d8262bae369310.png)

ä¿®æ”¹arg3ï¼Œå‘ç°æ•°æ®å˜äº†ï¼ŒæŒ‰ç…§ä¸Šé¢çš„åŠæ³•åˆ†æä¸€éï¼Œæœ€ç»ˆå¾—å‡ºä»£ç ï¼š

![](https://img.meituan.net/imgupload/7a2bb789acca0166123fd4d22563de92105532.png)</textarea></div>
                <script>
                   $(function () {
                        //é€šè¿‡editor.mdæ¸²æŸ“å†…å®¹
                        editormd.markdownToHTML("content");
                    })
                    
                </script>


                                

                </div>

                <hr>
                è¯„è®ºåˆ—è¡¨
                <!-- è¯„è®ºåˆ—è¡¨ -->
                <div id="comment-list" class="">

                    
                    
                    

                </div>


                <div class="mt-3 d-flex align-items-center justify-content-end">
                    <!-- <span class="mr-2 f14 text-secondary mt-2">ç¼–è¾‘äº2021-12-07 15:51:46</span> -->
                    <a type="button" id="toggleButton" style="color:#fff" rel="nofollow" class="btn btn-primary btn-sm mt-2">
                        å†™è¯„è®º
                    </a>
                </div>

                <!-- è¾“å…¥è¯„è®º -->
                <div class="replies mt-4" style="display: none;" id="replies">
                    <div class="card">
                        <div class="card-body py-0 px-3">
                            <ul class="list-group list-group-flush reply-list">
                                <li class="list-group-item text-center px-0 my4 text-secondary no-reply">
                                    <small>æ‚¨çš„IP:,ä¸´æ—¶ç”¨æˆ·å:18c428cb<br>è¯„è®ºå·²æ¥å…¥DepyWAFå®¡è®¡ä¸æµé‡ç³»ç»Ÿ,è¯·å‹¿é¢‘ç¹æ“ä½œå¯¼è‡´IPæ‹‰é»‘</small>
                                </li>
                                                                                </ul>
                        </div>

                                                                    <div class="card-body p-3 border-top">
                            <div>
                                <textarea autoheight="true" id="comment" class="form-control form-control-sm reply-textarea" rows="1" placeholder="æ’°å†™è¯„è®º ..." name="text"></textarea>
                            </div>
                            <div class="mt-y d-flex align-content-center justify-content-end">
                                <input id="verify" class="form-control mt-3 mx-4" style="width: 100px" type="search" name="verify" placeholder="code" value="" autocomplete="off">
                                <div style="margin-top:20px" id="verifypic"><img width="10%" src="data:image/png;base64,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"></div>
                            </div>
                            <a id="key" data="65bdfe43b60f2"></a>
                            <a id="view_id" data="118"></a>
                            <div class="mt-y d-flex align-content-center justify-content-end">
                                <button type="button" id="submitComment" submit-type="reply" class="btn btn-primary btn-sm mt-3">
                                    æäº¤è¯„è®º
                                </button>
                            </div>
                        </div>
                        
                    </div>
                </div>

                <hr><div>



                    <h5>Â© ç‰ˆæƒå£°æ˜ï¼šéæ ‡æ³¨ã€è½¬è½½ã€æƒ…å†µä¸‹æœ¬æ–‡ä¸ºåŸåˆ›æ–‡ç« ï¼Œç‰ˆæƒå½’&nbsp;<a href="https://docs.depy.ink">Depy's docs</a>&nbsp;æ‰€æœ‰ï¼Œè½¬è½½è¯·è”ç³»åšä¸»è·å¾—æˆæƒã€‚</h5>
                    
                </div>
            </article>

            

    <div class="ad d-none d-lg-block">
        
        <div style="margin-left: 20px;margin-bottom:15px;font-weight:bold"> ã€ç›®å½•ã€ </div>
    <div class="anchorContent" id="anchorContent"> </div>
            
                        
                       </div>
    
            </div>
    </section>
    <button class="sidebar-toggle sidebar-toggle-button" aria-label="Menu">
        <div><span></span><span></span><span></span></div>
    </button>


    
</main>

<link href="https://rce.ink/theme/docs/css/prettify.css?v=5530" rel="stylesheet">
<script src="https://rce.ink/theme/docs/js/prettify.js?v=5764"></script>
<script src="https://rce.ink/theme/docs/js/view.js?v=4125"></script>


        
<script>


    // å®šä¹‰æ°´å°å‡½æ•°
    function addWatermark({
        container = document.body, // æ°´å°æ·»åŠ åˆ°çš„å®¹å™¨ï¼Œé»˜è®¤ä¸º body
        width = "220px", // æ°´å° canvas çš„å®½åº¦
        height = "160px", // æ°´å° canvas çš„é«˜åº¦
        textAlign = "center", // æ°´å°æ–‡å­—çš„å¯¹é½æ–¹å¼
        textBaseline = "middle", // æ°´å°æ–‡å­—çš„åŸºçº¿
        font = "16px Microsoft Yahei", // æ°´å°æ–‡å­—çš„å­—ä½“
        fillStyle = "rgba(184, 184, 184, 0.6)", // æ°´å°æ–‡å­—çš„å¡«å……æ ·å¼
        content = "depy|rce.ink", // æ°´å°æ–‡å­—çš„å†…å®¹
        rotate = "45", // æ°´å°æ–‡å­—çš„æ—‹è½¬è§’åº¦
        zIndex = 10000, // æ°´å°çš„ z-index å€¼
    }) {
        // ç”Ÿæˆæ°´å° canvas
        const canvas = document.createElement("canvas");
        canvas.setAttribute("width", width);
        canvas.setAttribute("height", height);
        const ctx = canvas.getContext("2d");
        ctx.textAlign = textAlign;
        ctx.textBaseline = textBaseline;
        ctx.font = font;
        ctx.fillStyle = fillStyle;
        ctx.rotate((Math.PI / 180) * rotate);
        ctx.fillText(content, parseFloat(width) / 2, parseFloat(height) / 2);

        // å°† canvas è½¬æ¢ä¸º base64 URL
        const base64Url = canvas.toDataURL();
        const __wm = document.querySelector('.__wm');
        const watermarkDiv = __wm || document.createElement("div");
        const styleStr = `
                    position: fixed;
                    top: -70px;
                    left: 0;
                    bottom: 0;
                    right: 0;
                    width: 100%;
                    height: 100%;
                    z-index: ${zIndex};
                    pointer-events: none;
                    background-repeat: repeat;
                    background-image: url('${base64Url}')
                `;
        watermarkDiv.setAttribute("style", styleStr);
        watermarkDiv.classList.add("__wm"); 
        //åˆ™åˆ›å»ºä¸€ä¸ª div å¹¶è®¾ç½®æ ·å¼å’Œç±»å

        if (!__wm) {
            container.style.position = 'relative';
            container.insertBefore(watermarkDiv, container.firstChild);
        }
            // ç›‘å¬å®¹å™¨å˜åŒ–ï¼Œå½“å®¹å™¨å‘ç”Ÿå˜åŒ–æ—¶é‡æ–°è°ƒç”¨ addWatermark å‡½æ•°
            const MutationObserver = window.MutationObserver || window.WebKitMutationObserver;
            if (MutationObserver) {
                let mo = new MutationObserver(function () {
                    const __wm = document.querySelector('.__wm');
                    // åªåœ¨__wmå…ƒç´ å˜åŠ¨æ‰é‡æ–°è°ƒç”¨__canvasWM
                    if ((__wm && __wm.getAttribute('style') !== styleStr) || !__wm) {
                        // é¿å…ä¸€ç›´è§¦å‘
                        mo.disconnect();
                        mo = null;
                        console.log('1');
                        addWatermark({
                            container: document.getElementById("watermark"),
                            width: "220px",
                            height: "160px",
                            textAlign: "center",
                            textBaseline: "middle",
                            font: "16px Microsoft Yahei",
                            fillStyle: "rgba(184, 184, 184, 0.3 )",
                            content: "depy|rce.ink",
                            rotate: "30",
                            zIndex: 10000,
                        });
                    }
                });

                mo.observe(container, {
                    attributes: true,
                    subtree: true,
                    childList: true
                });
            }
    }



    function addwm(){
    addWatermark({
        container: document.getElementById("watermark"),
        width: "220px",
        height: "160px",
        textAlign: "center",
        textBaseline: "middle",
        font: "16px Microsoft Yahei",
        fillStyle: "rgba(184, 184, 184, 0.3 )",
        content: "depy|rce.ink",
        rotate: "30",
        zIndex: 10000,
    });
}

addwm();
</script>
        
</body>
</html>